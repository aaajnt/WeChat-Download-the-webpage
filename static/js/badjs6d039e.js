(function(v,i){if(typeof define==="function"){define("@tencent/wxg-report",i)}else{v.WX_BJ_REPORT=i()}})(window,function(){var v=window.WX_BJ_REPORT||{};(function(i){if(i.TryJs){return}var a=window;i.TryJs={isCatchTimeout:false,isCatchJquery:false,isCatchCmd:false,isTryed:false,_onThrow:function(e){if(e.stack&&console&&console.error){}}};function g(e){return typeof e==="function"};var m=function(e,s){return function(){try{return e.apply(this,s||arguments)}catch(o){i.TryJs._onThrow(o)}}};function J(e){return function(){var s,o=[];for(var l=0,h=arguments.length;l<h;l++){s=arguments[l];g(s)&&(s=m(s));o.push(s)}return e.apply(this,o)}};var T=function(e,s){return function(){try{return e.apply(this,arguments)}catch(o){i.TryJs._onThrow(o,{cid:s})}}};function r(e,s){return function(){var o,l,h=[];for(var p=0,f=arguments.length;p<f;p++){o=arguments[p];g(o)&&(l=m(o))&&(o.tryWrap=l)&&(o=l);h.push(o)}return e.apply(s||this,h)}};function t(e){var s,o;for(s in e){o=e[s];if(g(o))e[s]=m(o)}return e};function n(){if(i.TryJs.isCatchJquery){return i.TryJs}var e=a.jQuery;if(!e||!e.event){return}var s=e.event.add,o=e.ajax,l=e.event.remove;if(s){e.event.add=r(s);e.event.remove=function(){var f,y=[];for(var w=0,_=arguments.length;w<_;w++){f=arguments[w];g(f)&&(f=f.tryWrap);y.push(f)}return l.apply(this,y)}}if(o){e.ajax=function(f,y){if(!y){y=f;f=void 0}t(y);if(f)return o.call(e,f,y);return o.call(e,y)}}if(jQuery.zepto){var h=e.fn.on;var p=e.fn.off;e.fn.on=r(h);e.fn.off=function(){var f,y=[];for(var w=0,_=arguments.length;w<_;w++){f=arguments[w];g(f)&&(f=f.tryWrap);y.push(f)}return p.apply(this,y)}}i.TryJs.isCatchJquery=true;return i.TryJs}function c(){if(i.TryJs.isCatchTimeout){return i.TryJs}var e=function(s){return function(o,l){if(typeof o==="string"){try{o=new Function(o)}catch(p){throw p}}var h=[].slice.call(arguments,2);o=m(o,h.length&&h);return s(o,l)}};a.setTimeout=e(a.setTimeout);a.setInterval=e(a.setInterval);i.TryJs.isCatchTimeout=true;return i.TryJs};function u(e,s){var o;for(o in s){e[o]=s[o]}return e};function d(){if(i.TryJs.isCatchCmd){return i.TryJs}var e=a.require,s=a.define;if(a.seajs&&s){a.define=function(){var o,l=[];for(var h=0,p=arguments.length;h<p;h++){o=arguments[h];if(g(o)){o=T(o,arguments[0]);o.toString=function(f){return function(){return f.toString()}}(arguments[h])}l.push(o)}return s.apply(this,l)};a.seajs.use=J(a.seajs.use);u(a.define,s);i.TryJs.isCatchCmd=true}return i.TryJs}function E(){n();d();c()}function j(e){e&&(i.TryJs._onThrow=e);E()}return i.TryJs=u(i.TryJs,{init:j,catchJquery:n,catchCmd:d,run:E})})(v);(function(i){if(i.BadJs){return}var a="BadjsWindowError";var g=function(r,t){r=r||{};if(typeof r==="string"){r={vale:r}}for(var n in t){r[n]=t[n]}return r};i.BadJs={uin:0,mid:"",_cache:{},_info:{},_hookCallback:null,ignorePath:true,throw:function(r,t){this.onError(r,t);throw r},onError:function(r,t){try{if(r.BADJS_EXCUTED==true){return}r.BADJS_EXCUTED=true;var n=J(r);n.uin=this.uin;n.mid=this.mid;n.view=this.view;if(!!t){t._info=t.info;n=g(n,t)}if(n.cid){n.key="["+n.cid+"]:"+n.key}n._info=g(n._info,this._info);if(n._info){if(Object.prototype.toString.call(n._info)=="[object Object]"){n.msg+=" || info:"+JSON.stringify(n._info)}else if(Object.prototype.toString.call(n._info)=="[object String]"){n.msg+=" || info:"+n._info}else{n.msg+=" || info:"+n._info}}if(typeof this._hookCallback=="function"){if(this._hookCallback(n)===false){return}}this._send(n);return i.BadJs}catch(c){}},winErr:function(r){if(r.type==="unhandledrejection"){i.BadJs.onError(m(r.type,r.reason,"","","",r.reason))}else{if(r.error&&r.error.BADJS_EXCUTED){return}i.BadJs.onError(m(a,r.message,r.filename,r.lineno,r.colno,r.error))}},init:function(r,t,n,c){this.uin=r||this.uin;this.mid=t||this.mid;this.view=n||this.view;if(c!==false){i.TryJs.init(function(u,d){i.BadJs.throw.call(i.BadJs,u,d)});window.addEventListener&&window.addEventListener("error",i.BadJs.winErr);window.addEventListener&&window.addEventListener("unhandledrejection",i.BadJs.winErr)}return i.BadJs},hook:function(r){this._hookCallback=r;return i.BadJs},_send:function(r){if(!r.mid){return}var t=[r.mid,r.name,r.key].join("|");if(this._cache&&this._cache[t]){return}else{this._cache&&(this._cache[t]=true);this._xhr(r)}try{if(!window.jsError){window.jsError=[]}window.jsError&&window.jsError.push(r)}catch(n){}return i.BadJs},_xhr:function(r){var t;if(window.ActiveXObject){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(E){t=false}}}else if(window.XMLHttpRequest){t=new XMLHttpRequest}var n="";for(var c in r){if(c&&r[c]){n+=[c,"=",encodeURIComponent(r[c]),"&"].join("")}}if(t&&t.open){t.open("POST","https://badjs.weixinbridge.com/report",true);t.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");t.onreadystatechange=function(d){};t.send(n.slice(0,-1))}else{var u=new Image;u.src="https://badjs.weixinbridge.com/report?"+n}},report:function(r,t,n){this.onError(m(r,t),n);return this},mark:function(r){this._info=g(this._info,r)},nocache:function(){this._cache=false;return i.BadJs}};function m(r,t,n,c,u,d){return{name:r||"",message:t||"",file:n||"",line:c||"",col:u||"",stack:d&&d.stack||""}}function J(r){r._info=r.info||{};var t=T(r);return{name:r.name,key:r.message,msg:r.message,_info:r._info,stack:t.info,file:t.file,line:t.line,col:t.col,client_version:""}}function T(r){var t=r.stack||"";var n={info:t,file:r.file||"",line:r.line||"",col:r.col||""};if(n.file==""){var c=t.split(/\bat\b/);if(c&&c[1]){var u=/(https?:\/\/[^\n]+)\:(\d+)\:(\d+)/.exec(c[1]);if(u){if(u[1]&&u[1]!=n.file){n.file&&(r._info.file=n.file);n.file=u[1]}if(u[2]&&u[2]!=n.line){n.line&&(r._info.line=n.line);n.line=u[2]}if(u[3]&&u[3]!=n.col){n.col&&(r._info.col=n.col);n.col=u[3]}}}}if(n&&n.file&&n.file.length>0){n.info=n.info.replace(new RegExp(n.file.split("?")[0],"gi"),"__FILE__")}if(i.BadJs.ignorePath){n.info=n.info.replace(/http(s)?\:[^:\n]*\//ig,"").replace(/\n/gi,"")}return n}return i.BadJs})(v);return v});
