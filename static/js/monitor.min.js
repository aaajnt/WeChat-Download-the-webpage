!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Monitor=t()}(this,(function(){"use strict";Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o){o=Object(o);for(var i=Object.keys(Object(o)),r=0,a=i.length;r<a;r++){var s=i[r],c=Object.getOwnPropertyDescriptor(o,s);(null==c?void 0:c.enumerable)&&(t[s]=o[s])}}}return t}})
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */;var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};var t=function(){return(t=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function n(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))}var o,i=function(){function e(){var e=this;this.emit=function(t,n){if(e){var o,i=e.eventsList[t];if(null==i?void 0:i.length){i=i.slice();for(var r=0;r<i.length;r++){o=i[r];try{var a=o.callback.apply(e,[n]);if(1===o.type&&e.remove(t,o.callback),!1===a)break}catch(e){throw e}}}return e}},this.eventsList={}}return e.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},e.prototype.on=function(e,t,n){if(void 0===n&&(n=0),this){var o=this.eventsList[e];if(o||(this.eventsList[e]=[],o=this.eventsList[e]),-1===this.indexOf(o,t)){var i={name:e,type:n||0,callback:t};return o.push(i),this}return this}},e.prototype.one=function(e,t){this.on(e,t,1)},e.prototype.remove=function(e,t){if(this){var n=this.eventsList[e];if(!n)return null;if(!t){try{delete this.eventsList[e]}catch(e){}return null}if(n.length){var o=this.indexOf(n,t);n.splice(o,1)}return this}},e.prototype.clear=function(){this.eventsList={}},e}(),r=function(){var e=window.localStorage.getItem("MONITOR_ENV_ID");return e||(e=y(),window.localStorage.setItem("MONITOR_ENV_ID",e)),e},a=function(){var e=window.localStorage.getItem("MONITOR_UUID");return e||(e=y(),window.localStorage.setItem("MONITOR_UUID",e)),e};!function(e){e[e.number=-1]="number",e.string=""}(o||(o={}));var s,c,u,l,p,d,f=function(e,t){return"string"==typeof e?e.split("?")[t?1:0]||"":e},h=["application/octet-stream","application/xhtml+xml","application/xml","application/pdf","application/pkcs12","application/javascript","application/ecmascript","application/vnd.mspowerpoint","application/ogg","text/html","text/css","text/javascript","image","audio","video"],g=function(e){return h.some((function(t){return-1!==e.indexOf(t)}))},m=["code","errcode","err_code","errorcode","error_code","ret","retcode","ret_code","return_code"],v=["msg","errmsg","err_msg","errormsg","error_msg","retmsg","ret_msg","return_msg"],w=function(e,t,n){var o;try{if("function"==typeof(null==t?void 0:t.retHandler)){var i=t.retHandler(e,null==n?void 0:n.url,null==n?void 0:n.ctx)||{},r=i.code,a=i.isErr,s=i.msg;return{code:void 0===r?"unknown":r,msg:p=void 0===s?"":s,isErr:a}}"string"==typeof e&&(e=JSON.parse(e)),"function"==typeof(null===(o=null==t?void 0:t.ret)||void 0===o?void 0:o.join)&&(m=[].concat(t.ret.map((function(e){return e.toLowerCase()}))));var c=Object.getOwnPropertyNames(e),u=c.filter((function(e){return-1!==m.indexOf(e.toLowerCase())})),l=c.filter((function(e){return-1!==v.indexOf(e.toLowerCase())}));if(u.length){r=Number(e[u[0]]);var p=l.length?e[l[0]]:"";return{code:"".concat(r),msg:"".concat(p),isErr:0!==r}}return{code:"unknown",msg:"",isErr:!1}}catch(e){return{code:"unknown",msg:"",isErr:!1}}},y=function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}));return"".concat(e,"-").concat((new Date).getTime())},b=function(e,t){Object.getOwnPropertyNames(e).forEach((function(n){"function"==typeof e[n]&&"constructor"!==n&&(t?t[n]="sendPipeline"===n?function(){return function(){}}:function(){}:e[n]=function(){})}))},_=function(e){var t=document.cookie.match(new RegExp("(?:^|;\\s)".concat(e,"=(.*?)(?:;\\s|$)")));return(t=t?t[1]:"")&&(t=decodeURIComponent(t),t=decodeURIComponent(t),t=decodeURIComponent(t)),t},E="https://log.weixin.qq.com/xdc/sdkreport/report",x=function(){return{trackId:y(),sysId:"",delay:1e3,maxLength:10,actionUrl:"",envUrl:"",logUrl:"",resourceUrl:""}};!function(e){e.ACTION="action",e.ENV="env",e.RESOURCE="resource",e.LOG="log",e.PERFORMANCE="performance",e.PV="pv",e.EVENT="event",e.CUSTOM="custom",e.SDK_ERROR="sdkError",e.REPORT_COUNT="reportCount"}(s||(s={})),function(e){e[e.UnDefined=0]="UnDefined",e[e.Optional=1]="Optional",e[e.Normal=2]="Normal",e[e.Important=3]="Important"}(c||(c={})),function(e){e.HAPPEN_TIME="happen_time",e.REPORT_TIME="report_time",e.TRACK_ID="track_id",e.SYS_ID="sys_id",e.SEQ="seq",e.MODE="mode",e.UUID="uuid",e.USER_ID="user_id",e.REPORT_ID="report_id",e.XMONITOR_SDK_VERSION="xmonitor_sdk_version",e.ENV_ID="env_id"}(u||(u={})),function(e){e.Web="web",e.MiniApp="miniapp"}(l||(l={})),function(e){e.Undefined="undefined",e.Report="report_error",e.Plugin="plugin_errpr",e.Other="other"}(p||(p={})),function(e){e.Undefined="undefined",e.Env="env",e.Resource="resource",e.Log="log",e.Action="action",e.Performance="performance"}(d||(d={}));var S,O=function(e,t,n){var o,i=t||e.config.maxLength||10,r=[],a=e.config;return e.lifeCycle.on("destroy",(function(){r.length=0})),function(t,s){var c;r.push(t);var u=null===(c=e.config)||void 0===c?void 0:c.maxLength;if(10!==u&&"number"==typeof u&&u>0&&u<=50&&(i=u),i&&r.length>=i)return s(r.splice(0,r.length)),void(o&&clearTimeout(o));o&&clearTimeout(o),o=setTimeout((function(){o=null,r.length>0&&s(r.splice(0,r.length))}),n||a.delay)}},C=function(e,t){return function(n,o){var i=t?t(e):null;o(n.map((function(e){var t={};return e&&Object.keys(e).forEach((function(n){var o=(typeof e[n]).toLocaleLowerCase();e[n]instanceof Object?t[n]=JSON.stringify(e[n]):t[n]="string"===o?e[n].length<512?e[n]:e[n].substring(0,512):e[n]})),i?i(t):t})))}},R=function(){},k=function(e){if(!e||!e.reduce||!e.length)throw new TypeError("createPipeline need at least one function param");return 1===e.length?function(t,n){e[0](t,n||R)}:e.reduce((function(e,t){return function(n,o){return void 0===o&&(o=R),e(n,(function(e){return null==t?void 0:t(e,o)}))}}))},I=function(){function e(){this.sdkConfig={delay:2e3,sdkErrorUrl:"".concat(E,"/logerror"),logCountUrl:"".concat(E,"/logcount")},this.reportCountSend=null,this.actionReportCount=0,this.logReportCount=0,this.envReportCount=0,this.resourceReportCount=0,this.uuid="",this.logSeq=0,this.actionSeq=0,this.envSeq=0,this.resourceSeq=0,this.config=x(),this.lifeCycle=new i,this.bean={},this.common={},this.customField={},e.instances.push(this)}return e.prototype.init=function(t){this.generateUUID(),this.setConfig(t);for(var n=0;n<e.installedPlugins.length;n++)try{e.installedPlugins[n].patch(this)}catch(e){var o=this.generateSdkError();o.log_type=p.Plugin,o.log_txt=JSON.parse(e),this.sendSDKError(o)}},e.prototype.setConfig=function(e){var t=Object.assign(this.config.plugins||{},e.plugins||{});return Object.assign(this.config,e),this.config.plugins=t,this.config},e.use=function(t){-1===e.installedPlugins.indexOf(t)&&t.monitorPlugin&&e.installedPlugins.push(t)},e.unuse=function(t){var n=e.installedPlugins.indexOf(t);-1!==n&&e.installedPlugins.splice(n,1)},e.prototype.setCustomField=function(e){this.customField=e},e.prototype.getActionReportCount=function(){var e=this.actionReportCount;return this.actionReportCount=0,e},e.prototype.getLogReportCount=function(){var e=this.logReportCount;return this.logReportCount=0,e},e.prototype.getEnvReportCount=function(){var e=this.envReportCount;return this.envReportCount=0,e},e.prototype.getResouceReportCount=function(){var e=this.resourceReportCount;return this.resourceReportCount=0,e},e.prototype.getLogSeq=function(){return this.logSeq+=1},e.prototype.getActionSeq=function(){return this.actionSeq+=1},e.prototype.getEnvSeq=function(){return this.envSeq+=1},e.prototype.getResourceSeq=function(){return this.resourceSeq+=1},e.prototype.actionInfo=function(e){throw new Error('You need to override "actionInfo" method')},e.prototype.envInfo=function(e){throw new Error('You need to override "envInfo" method')},e.prototype.logInfo=function(e){throw new Error('You need to override "logInfo" method')},e.prototype.resouceInfo=function(e){throw new Error('You need to override "resouceInfo" method')},e.prototype.sendPipeline=function(e){var t=this;return k(n(n([],e,!0),[function(e,o){t.request(e,(function(){for(var t,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];o({isErr:!1,result:i,logType:null==e?void 0:e.type,count:e.reportCount}),null===(t=null==e?void 0:e.success)||void 0===t||t.call.apply(t,n([e],i,!1))}),(function(){for(var t,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];o({isErr:!0,result:i,logType:null==e?void 0:e.type,count:e.reportCount}),null===(t=null==e?void 0:e.fail)||void 0===t||t.call.apply(t,n([e],i,!1))}))},function(e){var n=e.count;if(n&&e.logType!==s.SDK_ERROR&&e.logType!==s.REPORT_COUNT){switch(e.logType){case s.ACTION:t.actionReportCount+=n;break;case s.ENV:t.envReportCount+=n;break;case s.LOG:t.logReportCount+=n;break;case s.RESOURCE:t.resourceReportCount+=n}t.reportCountSend||(t.reportCountSend=setTimeout((function(){t.sendLogCount(),t.reportCountSend=null}),t.sdkConfig.delay))}}],!1))},e.prototype.send=function(e,t,n){var o=this;return k([function(e,i){o.request(e,(function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];i({isErr:!1,result:n,logType:e.type,logs:e.log}),null==t||t.apply(void 0,n)}),(function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];i({isErr:!0,result:t,logType:e.type,logs:e.log}),null==n||n.apply(void 0,t)}))}])(e)},e.prototype.request=function(e,t,n){throw new Error('You need to override "request" method')},e.prototype.generateUUID=function(){throw new Error('You need to override "generateUUID" method')},e.prototype.generateSdkError=function(){throw new Error('You need to override "generateSdkError" method')},e.prototype.generateReportCount=function(){throw new Error('You need to override "generateSdkError" method')},e.prototype.sendLogCount=function(){var e=this;this.sendPipeline([function(t,n){var o;e.actionReportCount>0&&((o=e.generateReportCount()).report_count=e.getActionReportCount(),o.report_name=d.Action,o.seq_max=e.actionSeq,o.report_url_path=e.config.actionUrl||"",t.push(o));e.logReportCount>0&&((o=e.generateReportCount()).report_count=e.getLogReportCount(),o.report_name=d.Log,o.seq_max=e.logSeq,o.report_url_path=e.config.logUrl||"",t.push(o));e.envReportCount>0&&((o=e.generateReportCount()).report_count=e.getEnvReportCount(),o.report_name=d.Env,o.seq_max=e.envSeq,o.report_url_path=e.config.envUrl||"",t.push(o));e.resourceReportCount>0&&((o=e.generateReportCount()).report_count=e.getResouceReportCount(),o.report_name=d.Resource,o.seq_max=e.resourceSeq,o.report_url_path=e.config.resourceUrl||"",t.push(o));t.length>0&&n(t)},function(t){e.sendPipeline([function(t,n){n({url:e.sdkConfig.logCountUrl,type:s.REPORT_COUNT,data:"logs=".concat(encodeURIComponent(JSON.stringify(t))),contentType:"application/x-www-form-urlencoded",method:"post"})}])(t)}])([])},e.prototype.sendSDKError=function(e){var t=this;this.sendPipeline([O(this),function(e,t){e.forEach((function(e){e.report_time=(new Date).getTime()})),t(e)},function(e){t.sendPipeline([function(n,o){o({url:t.sdkConfig.sdkErrorUrl,type:s.SDK_ERROR,data:"logs=".concat(encodeURIComponent(JSON.stringify(e))),contentType:"application/x-www-form-urlencoded",method:"post"})}])(e)}])(e)},e.prototype.destroy=function(t){void 0===t&&(t=!1);var n,o,i,r=e.instances.indexOf(this);-1!==r&&e.instances.splice(r,1);for(var a=e.installedPlugins.length-1;a>=0;a--)try{e.installedPlugins[a].unpatch(this)}catch(e){var s=this.generateSdkError();s.log_type=p.Plugin,s.log_txt=JSON.parse(e),this.sendSDKError(s)}if(this.lifeCycle.emit("destroy"),this.lifeCycle.clear(),t)n=this,i=Object.getOwnPropertyDescriptors(n),Object.keys(i).forEach((function(e){i[e].writable&&(o?o[e]=null:n[e]=null)})),Object.setPrototypeOf(this,null);else{var c=this;do{c.constructor!==Object&&b(c,this)}while(c=Object.getPrototypeOf(c));if(0===e.instances.length){var u=Object.getPrototypeOf(this).constructor;b(u),b(e)}}},e.version="1.1.7",e.instances=[],e.installedPlugins=[],e}(),T=function(){function e(e){this.monitorPlugin=!0,this.name="",this.alwaysUse=!1,this.instances=[],this.inited=!1,e.$walk=this.walk.bind(this),e.$getConfig=this.getConfig.bind(this),this.option=e,this.name=e.name}return e.prototype.patch=function(e){this.canUse(e)&&this.exist(e)&&(this.instances.push(e),this.triggerInit(e),this.triggerOnNewMonitor(e))},e.prototype.unpatch=function(e){var t=this.instances.indexOf(e);-1!==t&&this.instances.splice(t,1)},e.prototype.countInstance=function(){return this.instances.length},e.prototype.uninstall=function(){var e,t;null===(t=null===(e=this.option)||void 0===e?void 0:e.destroy)||void 0===t||t.apply(this)},e.prototype.canUse=function(e){var t=this.getConfig(e);return!(!t||"object"!=typeof t)||!!t},e.prototype.walk=function(e){var t=this;this.instances.forEach((function(n){var o=t.canUse(n);o&&e(n,o)}))},e.prototype.getConfig=function(e){var t,n;return null===(n=null===(t=e.config)||void 0===t?void 0:t.plugins)||void 0===n?void 0:n[this.name]},e.prototype.exist=function(e){return-1===this.instances.indexOf(e)},e.prototype.triggerInit=function(e){var t,n;this.inited||(this.inited=!0,null===(n=null===(t=this.option)||void 0===t?void 0:t.init)||void 0===n||n.call(this.option,this.getConfig(e)))},e.prototype.triggerOnNewMonitor=function(e){var t,n;null===(n=null===(t=this.option)||void 0===t?void 0:t.onNewMonitor)||void 0===n||n.call(this.option,e,this.getConfig(e))},e}(),N="model",L="name",P="type",j="vendor",A="version",q="mobile",D="tablet",U=function(e){return e.toLowerCase()},M=function(e,t){return"string"==typeof e&&-1!==U(t).indexOf(U(e))},F=function(e,t){if("string"==typeof e)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),void 0===t?e:e.substring(0,255)},V=function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var o=0;o<t[n].length;o++)if(M(t[n][o],e))return"?"===n?void 0:n}else if(M(t[n],e))return"?"===n?void 0:n;return e},B={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},G={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[A,[L,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[A,[L,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[L,A],[/opios[\/ ]+([\w\.]+)/i],[A,[L,"".concat("Opera"," Mini")]],[/\bopr\/([\w\.]+)/i],[A,[L,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[L,A],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[A,[L,"UC".concat("Browser")]],[/\bqbcore\/([\w\.]+)/i],[A,[L,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[A,[L,"WeChat"]],[/konqueror\/([\w\.]+)/i],[A,[L,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[A,[L,"IE"]],[/yabrowser\/([\w\.]+)/i],[A,[L,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[L,/(.+)/,"$1 Secure ".concat("Browser")],A],[/\bfocus\/([\w\.]+)/i],[A,[L,"".concat("Firefox"," Focus")]],[/\bopt\/([\w\.]+)/i],[A,[L,"".concat("Opera"," Touch")]],[/coc_coc\w+\/([\w\.]+)/i],[A,[L,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[A,[L,"Dolphin"]],[/coast\/([\w\.]+)/i],[A,[L,"".concat("Opera"," Coast")]],[/miuibrowser\/([\w\.]+)/i],[A,[L,"MIUI ".concat("Browser")]],[/fxios\/([-\w\.]+)/i],[A,[L,"Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[L,"360 ".concat("Browser")]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[L,/(.+)/,"$1 ".concat("Browser")],A],[/(comodo_dragon)\/([\w\.]+)/i],[[L,/_/g," "],A],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[L,A],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[L],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[L,"Facebook"],A],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[L,A],[/\bgsa\/([\w\.]+) .*safari\//i],[A,[L,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[A,[L,"".concat("Chrome"," Headless")]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[L,"".concat("Chrome"," WebView")],A],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[A,[L,"Android ".concat("Browser")]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[L,A],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[A,[L,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[A,L],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[L,[A,V,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[L,A],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[L,"Netscape"],A],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[A,[L,"".concat("Firefox"," Reality")]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[L,A]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[N,[j,"Samsung"],[P,D]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[N,[j,"Samsung"],[P,q]],[/\((ip(?:hone|od)[\w ]*);/i],[N,[j,"Apple"],[P,q]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[N,[j,"Apple"],[P,D]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[N,[j,"Huawei"],[P,D]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[N,[j,"Huawei"],[P,q]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[N,/_/g," "],[j,"Xiaomi"],[P,q]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[N,/_/g," "],[j,"Xiaomi"],[P,D]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[N,[j,"OPPO"],[P,q]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[N,[j,"Vivo"],[P,q]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[N,[j,"Realme"],[P,q]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[N,[j,"Motorola"],[P,q]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[N,[j,"Motorola"],[P,D]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[N,[j,"LG"],[P,D]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[N,[j,"LG"],[P,q]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[N,[j,"Lenovo"],[P,D]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[N,/_/g," "],[j,"Nokia"],[P,q]],[/(pixel c)\b/i],[N,[j,"Google"],[P,D]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[N,[j,"Google"],[P,q]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[N,[j,"Sony"],[P,q]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[N,"Xperia Tablet"],[j,"Sony"],[P,D]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[N,[j,"OnePlus"],[P,q]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[N,[j,"Amazon"],[P,D]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[N,/(.+)/g,"Fire Phone $1"],[j,"Amazon"],[P,q]],[/(playbook);[-\w\),; ]+(rim)/i],[N,j,[P,D]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[N,[j,"BlackBerry"],[P,q]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[N,[j,"ASUS"],[P,D]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[N,[j,"ASUS"],[P,q]],[/(nexus 9)/i],[N,[j,"HTC"],[P,D]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[j,[N,/_/g," "],[P,q]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[N,[j,"Acer"],[P,D]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[N,[j,"Meizu"],[P,q]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[N,[j,"Sharp"],[P,q]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[j,N,[P,q]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[j,N,[P,D]],[/(surface duo)/i],[N,[j,"Microsoft"],[P,D]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[N,[j,"Fairphone"],[P,q]],[/(u304aa)/i],[N,[j,"AT&T"],[P,q]],[/\bsie-(\w*)/i],[N,[j,"Siemens"],[P,q]],[/\b(rct\w+) b/i],[N,[j,"RCA"],[P,D]],[/\b(venue[\d ]{2,7}) b/i],[N,[j,"Dell"],[P,D]],[/\b(q(?:mv|ta)\w+) b/i],[N,[j,"Verizon"],[P,D]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[N,[j,"Barnes & Noble"],[P,D]],[/\b(tm\d{3}\w+) b/i],[N,[j,"NuVision"],[P,D]],[/\b(k88) b/i],[N,[j,"ZTE"],[P,D]],[/\b(nx\d{3}j) b/i],[N,[j,"ZTE"],[P,q]],[/\b(gen\d{3}) b.+49h/i],[N,[j,"Swiss"],[P,q]],[/\b(zur\d{3}) b/i],[N,[j,"Swiss"],[P,D]],[/\b((zeki)?tb.*\b) b/i],[N,[j,"Zeki"],[P,D]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[j,"Dragon Touch"],N,[P,D]],[/\b(ns-?\w{0,9}) b/i],[N,[j,"Insignia"],[P,D]],[/\b((nxa|next)-?\w{0,9}) b/i],[N,[j,"NextBook"],[P,D]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[j,"Voice"],N,[P,q]],[/\b(lvtel\-)?(v1[12]) b/i],[[j,"LvTel"],N,[P,q]],[/\b(ph-1) /i],[N,[j,"Essential"],[P,q]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[N,[j,"Envizen"],[P,D]],[/\b(trio[-\w\. ]+) b/i],[N,[j,"MachSpeed"],[P,D]],[/\btu_(1491) b/i],[N,[j,"Rotor"],[P,D]],[/(shield[\w ]+) b/i],[N,[j,"Nvidia"],[P,D]],[/(sprint) (\w+)/i],[j,N,[P,q]],[/(kin\.[onetw]{3})/i],[[N,/\./g," "],[j,"Microsoft"],[P,q]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[N,[j,"Zebra"],[P,D]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[N,[j,"Zebra"],[P,q]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[j,N,[P,"console"]],[/droid.+; (shield) bui/i],[N,[j,"Nvidia"],[P,"console"]],[/(playstation [345portablevi]+)/i],[N,[j,"Sony"],[P,"console"]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[N,[j,"Microsoft"],[P,"console"]],[/smart-tv.+(samsung)/i],[j,[P,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[N,/^/,"SmartTV"],[j,"Samsung"],[P,"smarttv"]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[j,"LG"],[P,"smarttv"]],[/(apple) ?tv/i],[j,[N,"".concat("Apple"," TV")],[P,"smarttv"]],[/crkey/i],[[N,"".concat("Chrome","cast")],[j,"Google"],[P,"smarttv"]],[/droid.+aft(\w)( bui|\))/i],[N,[j,"Amazon"],[P,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[N,[j,"Sharp"],[P,"smarttv"]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[j,F],[N,F],[P,"smarttv"]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[P,"smarttv"]],[/((pebble))app/i],[j,N,[P,"wearable"]],[/droid.+; (glass) \d/i],[N,[j,"Google"],[P,"wearable"]],[/droid.+; (wt63?0{2,3})\)/i],[N,[j,"Zebra"],[P,"wearable"]],[/(quest( 2)?)/i],[N,[j,"Facebook"],[P,"wearable"]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[j,[P,"embedded"]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[N,[P,q]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[N,[P,D]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[P,D]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[P,q]],[/(android[-\w\. ]{0,9});.+buil/i],[N,[j,"Generic"]]],os:[[/microsoft (windows) (vista|xp)/i],[L,A],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[L,[A,V,B]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[L,"Windows"],[A,V,B]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[A,/_/g,"."],[L,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[L,"Mac OS"],[A,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[A,L],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[L,A],[/\(bb(10);/i],[A,[L,"BlackBerry"]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[A,[L,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[A,[L,"".concat("Firefox"," OS")]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[A,[L,"webOS"]],[/crkey\/([\d\.]+)/i],[A,[L,"".concat("Chrome","cast")]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[L,"Chromium OS"],A],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[L,A],[/(sunos) ?([\w\.\d]*)/i],[[L,"Solaris"],A],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[L,A]]},H=function(e,t){for(var n,o,i,r,a,s,c=0;c<t.length&&!a;){var u=t[c],l=t[c+1];for(n=o=0;n<u.length&&!a;)if(a=u[n++].exec(e))for(i=0;i<l.length;i++)s=a[++o],"object"==typeof(r=l[i])&&r.length>0?2===r.length?"function"==typeof r[1]?this[r[0]]=r[1].call(this,s):this[r[0]]=r[1]:3===r.length?"function"!=typeof r[1]||r[1].exec&&r[1].test?this[r[0]]=s?s.replace(r[1],r[2]):void 0:this[r[0]]=s?r[1].call(this,s,r[2]):void 0:4===r.length&&(this[r[0]]=s?r[3].call(this,s.replace(r[1],r[2])):void 0):this[r]=s||void 0;c+=2}},z=navigator.userAgent;!function(e){e.unknown="other",e.wifi="wifi",e.net2g="2g",e.net3g="3g",e.net4g="4g",e.net5g="5g",e.net6g="6g"}(S||(S={}));var X=new T({name:"env",onNewMonitor:function(e){var t,n,o=((t={})[L]=void 0,t[A]=void 0,H.call(n=t,z,G.browser),n),i=function(){var e,t=((e={})[L]=void 0,e[A]=void 0,e);return H.call(t,z,G.os),t}(),r={happen_time:(new Date).getTime(),ua:navigator.userAgent,model:"".concat(i.name),browser:"".concat(o.name," ").concat(o.version),network_type:J(),referer:encodeURIComponent(window.location.href||"")};e.envInfo(r)}}),J=function(){var e,t="",n=navigator.userAgent.match(/NetType\/(\w+)/);return n?t=n[1]:navigator.connection&&(t=navigator.connection.effectiveType||navigator.connection.type),t||(t="unknown"),e=t,(e=String(e).toLowerCase()).indexOf("4g")>=0?S.net4g:e.indexOf("wifi")>=0?S.wifi:e.indexOf("5g")>=0?S.net5g:e.indexOf("6g")>=0?S.net6g:e.indexOf("3g")>=0?S.net3g:e.indexOf("2g")>=0?S.net2g:S.unknown};const Y=function(){if("object"!=typeof window)return;let e={};function t(t,n,o){e[t]=e[t]||[],e[t][n]=e[t][n]||[],o<0||(n<21?e[t][n][0]=o:e[t][n].push(o))}function n(e){if(e&&e.pid)return`${e.pid}_${e.uin||0}_${e.rid||0}`;console&&console.error("Must provide a pid")}function o(e,t){const n=e.pid_uin_rid.split("_");if(3!=n.length)return void(console&&console.error("pid,uin,rid, invalid args"));const o=t+`pid=${n[0]}&uin=${n[1]}&rid=${n[2]}`+"&speeds=";let i="";const r=[];for(var a=1;a<e.speeds.length;a++)if(e.speeds[a]){for(let t=0;t<e.speeds[a].length;t++){const n=`${a}_${e.speeds[a][t]}`;o.length+i.length+n.length<1024?i=i+n+";":(i.length&&r.push(o+i.substring(0,i.length-1)),i=n+";")}a==e.speeds.length-1&&r.push(o+i.substring(0,i.length-1))}for(a=0;a<r.length;a++)(new Image).src=r[a]}let i=[];function r(e){"complete"==document.readyState?e():i.push(e)}function a(){for(let e=0;e<i.length;e++)i[e]();i=[]}return window.addEventListener?window.addEventListener("load",a,!1):window.attachEvent&&window.attachEvent("onload",a),{saveSpeeds:function(e){if(!e.pid||!e.speeds)return-1;if(!e.speeds.length>0){const t=e.speeds;e.speeds=[],e.speeds.push(t)}const o=n(e);for(let n=0;n<e.speeds.length;n++){const i=e.speeds[n];i.time=parseInt(i.time),i.sid>20&&i.time>=0&&t(o,i.sid,i.time)}},send:function(){r(()=>{setTimeout(()=>{for(const t in e)o({pid_uin_rid:t,speeds:e[t]},"https://badjs.weixinbridge.com/frontend/reportspeed?");e={}},100)})},setFirstViewTime:function(e){r(()=>{if(!e.pid||!e.time)return-1;t(n(e),9,e.time)})},setBasicTime:function(o){r(()=>{const i=n(o);e[i]||(e[i]=[]);const r=window.performance||window.msPerformance||window.webkitPerformance||{};if(r&&r.timing){const n=r.timing||{};t(i,1,n.domainLookupEnd-n.domainLookupStart),t(i,2,"https:"==location.protocol&&0!=n.secureConnectionStart?n.connectEnd-n.secureConnectionStart:0),t(i,3,n.connectEnd-n.connectStart),t(i,4,n.responseStart-n.requestStart),t(i,5,n.responseEnd-n.responseStart),t(i,6,n.domContentLoadedEventStart-n.domLoading),t(i,7,0==n.domComplete?0:n.domComplete-n.domLoading),t(i,8,0==n.loadEventEnd?0:n.loadEventEnd-n.loadEventStart),setTimeout(()=>{n.loadEventEnd&&(t(i,7,0==n.domComplete?0:n.domComplete-n.domLoading),t(i,8,0==n.loadEventEnd?0:n.loadEventEnd-n.loadEventStart))},0),e[i][9]||t(i,9,n.domContentLoadedEventStart-n.navigationStart),t(i,10,n.redirectEnd-n.redirectStart),t(i,11,n.domainLookupStart-n.fetchStart),t(i,12,n.domLoading-n.responseStart)}})}}}();var $,K,W,Q=function(e){return function(t){var n="".concat(t.url||"");return e.sendPipeline([function(o,i){return i({url:n,type:t.type,reportCount:t.data?t.data.length:0,data:"logs=".concat(encodeURIComponent(JSON.stringify(t.data))),contentType:"application/x-www-form-urlencoded",method:"post",success:function(t){if(""!==t){var n=e.generateSdkError();n.log_type=p.Report,n.log_level=c.Important,n.log_txt=t,e.sendSDKError(n)}"function"==typeof i&&i([])},fail:function(t){var n=e.generateSdkError();n.log_type=p.Report,n.log_level=c.Important,n.log_txt="fail:".concat(JSON.stringify(t)),e.sendSDKError(n)}})}])(t)}},Z=function(){return Object.assign(x()||{},{delay:3e3,cookieName:"",mode:"",isOaPage:!1,isOnGraphId:!1,version:"",appVersion:"",plugins:{autoReport:!1,h5:!0,asset:!0,cgi:{cgiTimeout:1e4,cgiUrlBlackList:[]},error:!0,env:!0,quality:!1}})};!function(e){e.HAPPEND="happen_time",e.PAGE_FROM="page_from",e.EVENT="action",e.PAGE_URL="url",e.XPATH="position",e.ELEMENT_ID="element_id",e.CONTENT="element_content",e.TYPE="element_type",e.CLASS="element_class",e.STYLE="element_style",e.LINK="element_link"}($||($={})),function(e){e.CATON_ERROR="caton_error",e.CRASH_ERROR="crash_error",e.PROMISE_ERROR="promise_error",e.RESOURCE_ERROR="resource_error",e.JS_ERROR="js_error",e.CONSOLE="console",e.LOG="log"}(K||(K={})),function(e){e.QUALITY_VERIFY="xmonitor-sdk 校验不通过"}(W||(W={}));var ee=function(n){function o(e){var t,o=n.call(this)||this;o.saveSpeeds=Y.saveSpeeds,o.speedSend=Y.send,o.setFirstViewTime=Y.setFirstViewTime,o.setBasicTime=Y.setBasicTime,o.requestQueue=[],o.requesting=!1,o.actionPipeline=k([function(e,t){var n=o.config.beforeActionReport;if("function"==typeof n){var i=n(e);return!1===i||t(null!=i?i:e),!1}t(e)},function(e,t){o.lifeCycle.emit("beforeActionReportQuality",e),e.seq=o.getActionSeq(),t(e)},O(o),C(o,oe),function(e,t){t({type:s.ACTION,data:e,url:o.config.actionUrl})},Q(o)]),o.envPipeline=k([function(e,t){var n=o.config.beforeEnvReport;if("function"==typeof n){var i=n(e);return!1===i||t(null!=i?i:e),!1}t(e)},function(e,t){e.seq=o.getEnvSeq(),t(e)},O(o),C(o,oe),function(e,t){t({type:s.ENV,data:e,url:o.config.envUrl})},Q(o)]),o.logPipeline=k([function(e,t){var n=o.config.beforeLogReport;if("function"==typeof n){var i=n(e);return!1===i||t(null!=i?i:e),!1}t(e)},function(e,t){e.seq=o.getLogSeq(),t(e)},O(o),C(o,oe),function(e,t){t({type:s.LOG,data:e,url:o.config.logUrl})},Q(o)]),o.resourcePipeline=k([function(e,t){var n=o.config.beforeResourceReport;if("function"==typeof n){var i=n(e);return!1===i||t(null!=i?i:e),!1}t(e)},function(e,t){e.seq=o.getResourceSeq(),t(e)},O(o),C(o,oe),function(e,t){t({type:s.RESOURCE,url:o.config.resourceUrl,data:e})},Q(o)]);var i=Object.assign(Z().plugins||{},e.plugins||{});(null===(t=e.plugins)||void 0===t?void 0:t.cgi)&&(i.cgi=Object.assign(Z().plugins.cgi||{},e.plugins.cgi||{})),"idc"!==e.mode&&(i.quality=!0);var r=Object.assign(Z(),e||{});return r.plugins=i,o.init(r),o}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}(o,n),o.prototype.log=function(e){this.logInfo({happen_time:(new Date).getTime(),log_type:K.LOG,log_txt:e,log_level:c.Normal})},o.prototype.reportAction=function(e){var n,o,i=e.action;if(null!=i&&""!==i.trim()){var r=t(t({},e),{app_version:this.config.appVersion,happen_time:(new Date).getTime(),action:e.action||"",action_value:null!==(n=e.action_value)&&void 0!==n?n:"",module:e.module||"",page:e.page||(null===(o=this.config.router)||void 0===o?void 0:o.history.current.path)||"",page_from:""});this.actionInfo(r)}else console.warn("reportAction warn: 'action' is required")},o.prototype.logInfo=function(e){this.logPipeline(e)},o.prototype.envInfo=function(e){this.envPipeline(e)},o.prototype.actionInfo=function(e){this.actionPipeline(e)},o.prototype.generateUUID=function(){},o.prototype.generateSdkError=function(){return e=this,{happen_time:(new Date).getTime(),report_time:0,track_id:e.config.trackId||"",sys_id:e.config.sysId||"",user_id:e.config.userId||"",sdk_version:I.version,sdk_type:l.Web,log_level:c.Normal,env_id:r(),uuid:a(),log_type:p.Other};var e},o.prototype.generateReportCount=function(){return e=this,{happen_time:(new Date).getTime(),report_time:(new Date).getTime(),track_id:e.config.trackId||"",mode:e.config.mode,sys_id:e.config.sysId||"",sdk_version:I.version,sdk_type:l.Web,uuid:a(),seq_max:0,report_name:d.Undefined,report_count:0,report_abandon_count:0,report_url_path:""};var e},o.prototype.resouceInfo=function(e){"object"==typeof e&&this.resourcePipeline(e)},o.prototype.request=function(e,t,n){var o=e.url;if(o){e.url=o;var i=e.method||"get";if(!e)return console.log("Sending request blocked");var r=new XMLHttpRequest;r.sendByMonitor=!0,r.addEventListener("readystatechange",(function(){4===r.readyState&&(r.status>=400||0===r.status?null==n||n(r.response):null==t||t(r.response))})),"get"===i.toLocaleLowerCase()?(r.open("get",function(e,t){if("string"!=typeof e)return"";if("object"==typeof t&&t){var n=Object.getOwnPropertyNames(t).map((function(e){var n=t[e];return"".concat(e,"=").concat("string"==typeof n?encodeURIComponent(n):encodeURIComponent(JSON.stringify(n)))})).join("&").replace(/eval/gi,"evaI");return"".concat(e).concat(-1===e.indexOf("?")?"?":"&").concat(n)}return e}(e.url,e.data)),r.send()):(r.open("post",e.url),e.contentType&&r.setRequestHeader("Content-Type",e.contentType),"string"==typeof e.data&&(e.data=e.data.replace(/eval/gi,"evaI")),r.send(e.data))}},o.sessionID="session-".concat(Date.now()),o.maxLength=16384,o}(I);function te(e,t){return function(e,t,n){void 0===t&&(t=document);void 0===n&&(n=!1);var o=[],i=0;for(;e!==t;){if(i++>1e3)throw new Error("Got to maximum traversal level without reaching the root node.");var r=e.parentNode;if(null==r)break;for(var a=1,s=r.childNodes,c=e.nodeName,u=0,l=s.length;u<l&&s[u]!==e;u++)s[u].nodeName===c&&a++;"#text"===c?c="text()":"#comment"===c&&(c="comment()");var p=void 0;p=n||a>1?"[".concat(a,"]"):"",o.unshift(c+p),e=r}return o.join("/").toLowerCase()}(e,t)}var ne=function(){return void 0!==window.performance&&"function"==typeof performance.clearResourceTimings&&"function"==typeof performance.getEntriesByType&&"function"==typeof performance.now},oe=function(e){var t=(new Date).getTime();return function(n){var o=e.config,i={happen_time:n.happen_time,report_time:t,env_id:r(),uuid:a(),user_id:"".concat(o.userId||""),track_id:"".concat(o.trackId),sys_id:"".concat(o.sysId),mode:"".concat(o.mode),xmonitor_sdk_version:ee.version,report_id:y()};return o.isOaPage&&(i.user_id="".concat(_(o.cookieName)||_("t_uid")||_("username")||o.userId||"")),Object.assign(n||{},i)}};function ie(e){try{if(null!==e&&"object"===(typeof JSON.parse(e)).toLowerCase())return!0}catch(e){return!1}}function re(e){var t=[];if(ie(e)){var n=JSON.parse(e),o=function(e){if(Array.isArray(e)&&e.length>0){var n=e[0];if(Array.isArray(n))o(n);else{if(null===n||"object"!==(typeof n).toLocaleLowerCase())return;e=n}}else if(Array.isArray(e)&&0===e.length)return;Object.keys(e).forEach((function(n){if(t.push(n),null!==e[n]&&"object"===(typeof e[n]).toLocaleLowerCase()){var i=e[n];o(i)}}))};return o(n),JSON.stringify(t)}return""}function ae(e){var t=e.split("?"),n=t.length>=2?t[1].split("&"):[],o={};return n.forEach((function(e){var t=e.split("=");if(2===t.length){var n=t[0],i=t[1];o[n]=i}})),o}function se(e){var t,n=null===(t=e.router)||void 0===t?void 0:t.history.current.path,o="".concat(window.location.pathname).concat(window.location.hash.split("?")[0]);return n||o||""}function ce(e){return/mmpayfereport|api.cube.weixin.oa.com\/cube\/report\/reportbizdata/.test(e)}var ue=!1,le=[],pe=!1,de=[];const fe=function(e){const t=Array.prototype.forEach,n=Array.prototype.map;this.each=function(e,n,o){if(null!==e)if(t&&e.forEach===t)e.forEach(n,o);else if(e.length===+e.length){for(let t=0,i=e.length;t<i;t++)if(n.call(o,e[t],t,e)==={})return}else for(const t in e)if(e.hasOwnProperty(t)&&n.call(o,e[t],t,e)==={})return},this.map=function(e,t,o){const i=[];return e?n&&e.map===n?e.map(t,o):(this.each(e,(e,n,r)=>{i[i.length]=t.call(o,e,n,r)}),i):i},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.screen_orientation=e.screen_orientation,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)};fe.prototype={get(){const e=[];if(e.push(navigator.userAgent),e.push(navigator.language),e.push(screen.colorDepth),this.screen_resolution){const t=this.getScreenResolution();void 0!==t&&e.push(t.join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(this.hasIndexDb()),document.body?e.push(typeof document.body.addBehavior):e.push("undefined"),e.push(typeof window.openDatabase),e.push(navigator.cpuClass),e.push(navigator.platform),e.push(navigator.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},murmurhash3_32_gc(e,t){const n=3&e.length,o=e.length-n;let i=t;const r=3432918353,a=461845907;let s,c,u=0;for(;u<o;)c=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,c=(65535&c)*r+(((c>>>16)*r&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,s=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=27492+(65535&s)+((58964+(s>>>16)&65535)<<16);switch(c=0,n){case 3:c^=(255&e.charCodeAt(u+2))<<16;case 2:c^=(255&e.charCodeAt(u+1))<<8;case 1:c^=255&e.charCodeAt(u),c=(65535&c)*r+(((c>>>16)*r&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(65535&c)*a+(((c>>>16)*a&65535)<<16)&4294967295,i^=c}return i^=e.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0},hasLocalStorage(){try{return!!window.localStorage}catch(e){return!0}},hasSessionStorage(){try{return!!window.sessionStorage}catch(e){return!0}},hasIndexDb(){try{return!!window.indexedDB}catch(e){return!0}},isCanvasSupported(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},isIE:()=>"Microsoft Internet Explorer"===navigator.appName||!("Netscape"!==navigator.appName||!/Trident/.test(navigator.userAgent)),getPluginsString(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString(){return this.map(navigator.plugins,(function(e){const t=this.map(e,e=>[e.type,e.suffixes].join("~")).join(",");return[e.name,e.description,t].join("::")}),this).join(";")},getIEPluginsString(){if(window.ActiveXObject){const e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,e=>{try{return new ActiveXObject(e),e}catch(e){return null}}).join(";")}return""},getScreenResolution(){let e;return e=this.screen_orientation?screen.height>screen.width?[screen.height,screen.width]:[screen.width,screen.height]:[screen.height,screen.width],e},getCanvasFingerprint(){const e=document.createElement("canvas"),t=e.getContext("2d"),n="http://valve.github.io";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17),e.toDataURL()}};var he="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ge(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return me(null==t&&n.path)}},n.exports),n.exports}function me(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var ve=ge((function(e,t){var n,o=he&&he.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();void 0!==(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.genGraphId=t.getIpNum=void 0;var n=function(e,t){this.len=e,this.next=void 0,this.val=t},i=function(){function e(){this.len=0,this.head=new n(0,0),this.tail=this.head,this.states=null}return e.alloc=function(e){return new Uint8Array(e)},e.create=function(){return new e},e.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new r((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},e.prototype.finish=function(){for(var t=this.head.next,n=e.alloc(this.len),o=0;t;)t.fn(t.val,n,o),o+=t.len,t=t.next;return n},e}(),r=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.len=t,o.next=void 0,o.val=n,o}return o(t,e),t.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},t}(n);t.getIpNum=function(e){void 0===e&&(e="");var t="";return e.split(".").forEach((function(e){var n=Number(e).toString(2);t+="0".repeat(8-n.length)+n})),parseInt(t,2)};var a=-1;t.genGraphId=function(e){void 0===e&&(e="127.0.0.1");var n=String(Date.now()),o=n.substring(0,n.length-3),r=n.substring(n.length-3,n.length);a=(a+1)%1e9;var s=0;try{s=process.pid}catch(e){}return function(e){var t=i.create();return t.uint32(8).uint32(e.timestamp),t.uint32(16).uint32(e.timestampMs),t.uint32(24).uint32(e.ipv4),t.uint32(32).uint32(e.seq),t.uint32(40).uint32(e.tid),t}({timestamp:+o,timestampMs:+r,ipv4:(0,t.getIpNum)(e),seq:a,tid:s}).finish().reduce((function(e,t){return e+"0".concat(t.toString(16)).slice(-2)}),"").toUpperCase()}}(0,t))&&(e.exports=n)}));var we,ye=(new fe).get();function be(){var e,t="".concat((e=ye)>>>24&255,".").concat(e>>>16&255,".").concat(e>>>8&255,".").concat(255&e)||"127.0.0.1";return"".concat(ve.genGraphId(t))}!function(e){e.Get="get",e.Post="post"}(we||(we={}));var _e=new T({name:"cgi",override:!1,onNewMonitor:function(e){this.override||(this.override=!0,this.overrideFetch(e.config),this.overrideXhr(e.config))},overrideFetch:function(e){var t=this,n={name:this.name,beforeFetch:function(t,n){e.isOnGraphId&&(n.headers=new Headers({"X-Graph-Id":"".concat(be())}))},then:function(n,o,i,r){var a,s;if(!t.isInUrlBlackList(i,e)){var c=Date.now(),u=(null===(a=null==r?void 0:r.method)||void 0===a?void 0:a.toLowerCase())===we.Get?ae(i):(null==r?void 0:r.body)||"",l={source_url:i,source_type:"cgi",start_time:c-o,end_time:c,time_cost:o,method:(null===(s=null==r?void 0:r.method)||void 0===s?void 0:s.toLowerCase())||"",http_code:"".concat(n.status||0),payload:"string"==typeof u?u:JSON.stringify(u)};t.setGraphId(e,r,l);var p=n.headers?n.headers.get("content-type"):"";"fetch"===(n.ok&&"string"==typeof p&&g(p)?"static":"fetch")&&n.clone().text().then((function(o){e.isOaPage&&t.isOaPageInfo(i)&&(!(_("t_uid")||_("username"))&&ie(o)&&(document.cookie="username=".concat(JSON.parse(o).EngName)));var r=n.status<=0||n.status>=400;if(l.response=ie(o)?re(o):"",!r){var a=w(o,e.api,{url:i,ctx:n}),s=a.code,c=a.msg;l.ret_code=s,l.ret_msg=c}})),setTimeout((function(){t.reportCgiResourceTiming(l,e,"fetch")}),0),t.publishSpeed(l)}},catch:function(n,o,i,r){var a,s;if(!(e.url&&i.indexOf(e.url)>-1)){var c=Date.now(),u=(null===(a=null==r?void 0:r.method)||void 0===a?void 0:a.toLowerCase())===we.Get?ae(i):(null==r?void 0:r.body)||"",l={source_url:i,source_type:"cgi",start_time:c-o,end_time:c,time_cost:o,method:(null===(s=null==r?void 0:r.method)||void 0===s?void 0:s.toLowerCase())||"",http_code:"unknown",payload:"string"==typeof u?u:JSON.stringify(u)};throw t.setGraphId(e,r,l),t.publishSpeed(l),n}}};this.hackFetchOptions=n,function(e){if(de.find((function(t){return t.name===e.name})))throw new Error("name '".concat(e.name,"' is already in hackFetch option list"));if(de.push(e),!pe&&window.fetch){pe=!0;var t=window.fetch;window.fetch=function(e,n){void 0===n&&(n={});for(var o="string"==typeof e?e:e.url,i=0;i<de.length;i++){var r=de[i];try{"function"==typeof r.beforeFetch&&r.beforeFetch(o,n)}catch(e){}}var a=Date.now();return t(e,n).then((function(e){for(var t=0;t<de.length;t++){var i=de[t];try{"function"==typeof i.then&&i.then(e,Date.now()-a,o,n)}catch(e){}}return e})).catch((function(e){for(var t=0;t<de.length;t++){var i=de[t];try{"function"==typeof i.catch&&i.catch(e,Date.now()-a,o,n)}catch(e){}}throw e}))}}}(this.hackFetchOptions)},getRequestType:function(e){var t=e.getResponseHeader("content-type");return e.status>=400||"string"!=typeof t||!g(t)?"fetch":"static"},setGraphId:function(e,t,n){if(e.isOnGraphId){var o=(null==t?void 0:t.headers).get("X-Graph-Id");n.graph_id=o}},isOaPageInfo:function(e){return/\/ts:auth\/tauth\/info.ashx/.test(e)},isInUrlBlackList:function(e,t){var n;return!!t.plugins.cgi&&((null===(n=t.plugins.cgi)||void 0===n?void 0:n.cgiUrlBlackList)||[]).some((function(t){return"string"==typeof t&&e.indexOf(t)>-1||!!(t instanceof RegExp&&t.test(e))}))},overrideXhr:function(e){var t=this,n={name:this.name,send:function(n,o){var i=Date.now(),r="".concat(be());e.isOnGraphId&&n.setRequestHeader("X-Graph-Id",r),n.addEventListener("loadend",(function(){var a,s,c=n.monitorUrl;if(c&&!t.isInUrlBlackList(c,e)){var u=Date.now()-i,l=(null===(a=n.monitorMethod)||void 0===a?void 0:a.toLowerCase())===we.Get?o||ae(c):o,p={source_url:c,source_type:"cgi",start_time:i-u,end_time:i,time_cost:u,method:(null===(s=n.monitorMethod)||void 0===s?void 0:s.toLowerCase())||"",payload:"string"==typeof l?l:JSON.stringify(l),http_code:"".concat(n.status||0)};if("fetch"===t.getRequestType(n,c)){if(e.isOaPage&&t.isOaPageInfo(c))!(_("t_uid")||_("username"))&&ie(n.response)&&(document.cookie="username=".concat(JSON.parse(n.response).EngName));e.isOnGraphId&&(p.graph_id=r),p.response=ie(n.response)?re(n.response):"";try{var d=w(n.response,e.api,{url:c,ctx:n}),f=d.code,h=d.msg;p.ret_code=f,p.ret_msg=h}catch(e){p.ret_code="unknown"}}t.reportCgiResourceTiming(p,e,"xmlhttprequest"),t.publishSpeed(p)}}))}};this.hackXHROptions=n,function(e){if(le.find((function(t){return t.name===e.name})))throw new Error("name '".concat(e.name,"' is already in hackXHR option list"));if(le.push(e),!ue&&window.XMLHttpRequest){ue=!0;var t=window.XMLHttpRequest.prototype.send,n=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){if(this.monitorMethod=arguments[0],this.monitorUrl=arguments[1],this.monitorXhrStartTime=Date.now(),!this.sendByMonitor)for(var e=0;e<le.length;e++){var t=le[e];try{"function"==typeof t.open&&t.open(this)}catch(e){}}return n.apply(this,arguments)},window.XMLHttpRequest.prototype.send=function(){if(!this.sendByMonitor)for(var e=0;e<le.length;e++){var n=le[e];try{"function"==typeof n.send&&n.send(this,arguments[0])}catch(e){console.log("error")}}return t.apply(this,arguments)}}}(this.hackXHROptions)},reportCgiResourceTiming:function(e,t,n){var o,i,r,a;try{var s=(null===(o=t.plugins)||void 0===o?void 0:o.cgi)&&(null===(i=t.plugins)||void 0===i?void 0:i.cgi.cgiTimeout)?null===(a=null===(r=t.plugins)||void 0===r?void 0:r.cgi)||void 0===a?void 0:a.cgiTimeout:1e4;if(ne()&&e.time_cost>s){var c=performance.getEntriesByType("resource"),u=new RegExp(e.source_url),l=c.filter((function(e){return e.duration>s&&e.initiatorType===n&&u.test(e.name)})).sort((function(e,t){return t.duration-e.duration})).map((function(e){var t=e.redirectStart,n=e.redirectEnd,o=e.domainLookupStart,i=e.domainLookupEnd,r=e.connectStart,a=e.connectEnd,s=e.secureConnectionStart,c=e.responseStart,u=e.responseEnd,l={rdrS:t,rdrE:n,rdrT:n-t,dnsS:o,dnsE:i,dnsT:i-o,conS:r,conE:a,tcpT:a-r,sConS:s,sConT:a-s,respS:c,respE:u,respT:u-c};return Object.keys(l).forEach((function(e){l[e]=l[e].toFixed(0),"0"===l[e]&&delete l[e]})),l}));e.err_msg=JSON.stringify(l)||""}}catch(e){}},publishSpeed:function(e){e.source_url=f(e.source_url),this.$walk((function(t){t.resouceInfo(e)}))},destroy:function(){var e,t;this.option.publishSpeed=function(){},this.option.hackXHROptions&&(e=this.option.hackXHROptions,-1!==(t=le.findIndex((function(t){return t.name===e.name})))&&le.splice(t,1)),this.option.hackFetchOptions&&function(e){var t=de.findIndex((function(t){return t.name===e.name}));-1!==t&&de.splice(t,1)}(this.option.hackFetchOptions)}}),Ee=new T({name:"asset",collectCur:0,ASSETS_INITIATOR_TYPE:["img","css","script","link","audio","video","txt","json"],onNewMonitor:function(e){var t=this;try{if(!ne())return;this.collectSuccessLog(e),this.collectFailLog(e),performance.onresourcetimingbufferfull=function(){t.collectCur=0,performance.clearResourceTimings()}}catch(t){var n=e.generateSdkError();n.log_type=p.Plugin,n.log_txt="".concat(this.name,":").concat(JSON.stringify(t)),e.sendSDKError(n)}},publish:function(e){this.$walk((function(t){t.resouceInfo(e)}))},collectSuccessLog:function(e){var t=this,n=function(e){for(var n=0,o=e.length;n<o;n++){var i=e[n];-1===t.ASSETS_INITIATOR_TYPE.indexOf(i.initiatorType)||(r=i.name,/log.weixin.qq.com/.test(r))||ce(i.name)||t.publish(t.generateLog(i))}var r};if("function"==typeof window.PerformanceObserver){n(performance.getEntriesByType("resource"));var o=new window.PerformanceObserver((function(e){n(e.getEntries())}));o.observe({entryTypes:["resource"]}),e.lifeCycle.on("destroy",(function(){0===Ee.countInstance()&&o.disconnect()}))}else{var i=setInterval((function(){var e=performance.getEntriesByType("resource"),o=e.slice(t.collectCur);t.collectCur=e.length,n(o)}),3e3);e.lifeCycle.on("destroy",(function(){0===Ee.countInstance()&&clearInterval(i)}))}},collectFailLog:function(e){var t=this,n=function(e){if(e){var n=e.target||e.srcElement,o=(null==n?void 0:n.src)||(null==n?void 0:n.href),i=null==n?void 0:n.tagName;if(o&&"string"==typeof o){if("IMG"===i&&window.location.href.indexOf(o)>-1)return;var r=performance.getEntriesByType("resource").find((function(e){return e.name===o})),a=Number(((null==r?void 0:r.duration)||0).toFixed(0)),s=Date.now(),c={source_url:o,source_type:null==r?void 0:r.initiatorType,start_time:Number((s-a).toFixed(0)),end_time:s,time_cost:a,method:"get",http_code:"404"};t.publish(c)}}};window.document.addEventListener("error",n,!0),e.lifeCycle.on("destroy",(function(){0===Ee.countInstance()&&window.document.removeEventListener("error",n,!0)}))},generateLog:function(e){var t=Date.now(),n=Number(e.duration.toFixed(0));return{source_url:f(e.name),source_type:e.initiatorType,start_time:Number((t-n).toFixed(0)),end_time:t,time_cost:n,http_code:"200",method:"get"}},destroy:function(){this.option.publish=function(){}}}),xe=ge((function(e,t){
/*!
   Copyright 2018 Google Inc. All Rights Reserved.
   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
  */
/*! lifecycle.es5.js v0.1.1 */
e.exports=function(){var e=void 0;try{new EventTarget,e=!1}catch(t){e=!1}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},a=function(){function e(){n(this,e),this._registry={}}return o(e,[{key:"addEventListener",value:function(e,t){this._getRegistry(e).push(t)}},{key:"removeEventListener",value:function(e,t){var n=this._getRegistry(e),o=n.indexOf(t);o>-1&&n.splice(o,1)}},{key:"dispatchEvent",value:function(e){return e.target=this,Object.freeze(e),this._getRegistry(e.type).forEach((function(t){return t(e)})),!0}},{key:"_getRegistry",value:function(e){return this._registry[e]=this._registry[e]||[]}}]),e}(),s=e?EventTarget:a,c=e?Event:function e(t){n(this,e),this.type=t},u=function(e){function t(e,o){n(this,t);var i=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.newState=o.newState,i.oldState=o.oldState,i.originalEvent=o.originalEvent,i}return i(t,c),t}(),l="active",p="passive",d="hidden",f="frozen",h="terminated",g="object"===("undefined"==typeof safari?"undefined":t(safari))&&safari.pushNotification,m=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],v=function(e){return e.preventDefault(),e.returnValue="Are you sure?"},w=[[l,p,d,h],[l,p,d,f],[d,p,l],[f,d],[f,l],[f,p]].map((function(e){return e.reduce((function(e,t,n){return e[t]=n,e}),{})})),y=function(){return document.visibilityState===d?d:document.hasFocus()?l:p};return new(function(e){function t(){n(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=y();return e._state=o,e._unsavedChanges=[],e._handleEvents=e._handleEvents.bind(e),m.forEach((function(t){return addEventListener(t,e._handleEvents,!0)})),g&&addEventListener("beforeunload",(function(t){e._safariBeforeUnloadTimeout=setTimeout((function(){t.defaultPrevented||t.returnValue.length>0||e._dispatchChangesIfNeeded(t,d)}),0)})),e}return i(t,s),o(t,[{key:"addUnsavedChanges",value:function(e){!this._unsavedChanges.indexOf(e)>-1&&(0===this._unsavedChanges.length&&addEventListener("beforeunload",v),this._unsavedChanges.push(e))}},{key:"removeUnsavedChanges",value:function(e){var t=this._unsavedChanges.indexOf(e);t>-1&&(this._unsavedChanges.splice(t,1),0===this._unsavedChanges.length&&removeEventListener("beforeunload",v))}},{key:"_dispatchChangesIfNeeded",value:function(e,t){if(t!==this._state)for(var n=function(e,t){for(var n,o=0;n=w[o];++o){var i=n[e],r=n[t];if(i>=0&&r>=0&&r>i)return Object.keys(n).slice(i,r+1)}return[]}(this._state,t),o=0;o<n.length-1;++o){var i=n[o],r=n[o+1];this._state=r,this.dispatchEvent(new u("statechange",{oldState:i,newState:r,originalEvent:e}))}}},{key:"_handleEvents",value:function(e){switch(g&&clearTimeout(this._safariBeforeUnloadTimeout),e.type){case"pageshow":case"resume":this._dispatchChangesIfNeeded(e,y());break;case"focus":this._dispatchChangesIfNeeded(e,l);break;case"blur":this._state===l&&this._dispatchChangesIfNeeded(e,y());break;case"pagehide":case"unload":this._dispatchChangesIfNeeded(e,e.persisted?f:h);break;case"visibilitychange":this._state!==f&&this._state!==h&&this._dispatchChangesIfNeeded(e,y());break;case"freeze":this._dispatchChangesIfNeeded(e,f)}}},{key:"state",get:function(){return this._state}},{key:"pageWasDiscarded",get:function(){return document.wasDiscarded||!1}}]),t}())}()})),Se=new T({name:"error",onNewMonitor:function(e){window.onerror=function(t,n,o,i,r){if("Script error."!==t){var a={happen_time:(new Date).getTime(),log_level:c.Normal,log_type:K.JS_ERROR,log_stack:r?JSON.stringify(r.stack||r):"",col:i||0,line:o||0,file:n||"",log_txt:"string"===(typeof t).toLowerCase()?String(t):JSON.stringify(t)};e.logInfo(a)}else e.logInfo({log_type:K.JS_ERROR,log_level:c.Normal,log_txt:"Script Error: See Browser Console for Detail"});return!1};var t=window.console.error;window.console.error=function(){null==t||t.apply(window,arguments);var n=Object.values(W).map((function(e){return"(?=.*".concat(e,")")})).join("|"),o=JSON.stringify(arguments);if(!new RegExp(n).test(o)){var i={happen_time:(new Date).getTime(),log_level:c.Normal,log_type:K.CONSOLE,log_txt:o};e.logInfo(i)}},window.addEventListener("error",(function(t){var n=t.target,o=n instanceof HTMLScriptElement||n instanceof HTMLLinkElement;if(!(o=o||n instanceof HTMLImageElement))return!1;var i=(null==n?void 0:n.src)||(null==n?void 0:n.href)||"",r={happen_time:(new Date).getTime(),log_level:c.Normal,log_type:K.RESOURCE_ERROR,log_txt:i};e.logInfo(r)}),!0),window.addEventListener("unhandledrejection",(function(t){var n={happen_time:(new Date).getTime(),log_level:c.Normal,log_type:K.PROMISE_ERROR,log_txt:"string"===(typeof t.reason).toLowerCase()?t.reason:JSON.stringify(t.reason)};return e.logInfo(n),!0}));var n="good_exit_".concat(e.config.trackId),o="time_before_crash_".concat(e.config.trackId);window.addEventListener("load",(function(){localStorage.setItem(n,"pending"),setInterval((function(){localStorage.setItem(o,(new Date).toString())}),3e3)})),"Microsoft Internet Explorer"===navigator.appName&&parseInt(navigator.appVersion.split(";")[1].replace(/[ ]/g,"").replace("MSIE",""))<9?window.addEventListener("beforeunload",(function(){sessionStorage.setItem(n,"true")})):xe.addEventListener("statechange",(function(e){"hidden"===e.newState&&localStorage.setItem(n,"true"),"active"===e.newState&&localStorage.setItem(n,"pending")}));var i=[];localStorage.length&&(i=Object.keys(localStorage).filter((function(e){return/good_exit_/.test(e)})).map((function(e){return e.replace("good_exit_","")}))),i.forEach((function(t){var n="good_exit_".concat(t),o="time_before_crash_".concat(t);if(localStorage.getItem(o)&&t!==e.config.trackId){var i=localStorage.getItem(o);setTimeout((function(){if(i===localStorage.getItem(o)){if("true"!==localStorage.getItem(n)){var r={happen_time:i?new Date(i).getTime():0,log_level:c.Important,log_type:K.CRASH_ERROR,log_txt:t||""};e.logInfo(r)}localStorage.getItem(n)&&localStorage.removeItem(n),localStorage.removeItem(o)}}),6e3)}}));var r=function(e){var t=(new Date).getTime(),n=0;return function(){var o=(new Date).getTime(),i=o-t;if(t=o,1e3/i<=30&&(!n||n-o>=6e4)){n=o;var r={happen_time:o,log_level:c.Normal,log_type:K.CATON_ERROR,log_txt:"".concat((1e3/i).toFixed(0))};e.logInfo(r)}}}(e),a=function(){r(),window.requestAnimationFrame(a)};window.requestAnimationFrame(a)}});function Oe(e){return!!("object"==typeof HTMLElement?function(e){return e instanceof HTMLElement}:function(e){return e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName})(e)&&(!!function(e){return null!==e.getAttribute("auto-report-cicle")}(e)||!function(e){if(null!==e.getAttribute("auto-report-ignore"))return!0;var t=e;for(;null!==t.parentNode;){if(null!==t.getAttribute("auto-report-ignore"))return!0;t=t.parentNode}return!1}(e))}var Ce,Re,ke=new T({name:"autoReport",env:{},autoReportView:!1,onNewMonitor:function(e){this.monitor=e,this.initReportView(),this.initAutoReport(e)},initAutoReport:function(e){var t=this;this.clickListener=function(n){return Oe(n.target)&&t.webListener(n,e)},document.addEventListener("click",this.clickListener,!0),this.scrollListener=function(e,t){if(void 0===t&&(t=1e3),"function"!=typeof e)throw new TypeError("need a function arguments");var o,i=null,r=null;return function(){var a=this,s=arguments;return i?clearTimeout(i):r=(new Date).getTime(),i=setTimeout((function(){o=e.apply(a,n(n([],s,!0),[r],!1))}),t),o}}((function(n,o){return Oe(n.target)&&t.scrollHandle(n,o,e)})),document.addEventListener("scroll",this.scrollListener,!0)},initReportView:function(){var e=this,t=["http://test.xmonitor.wxpay.woa.com","https://xmonitor.wxpay.woa.com"];window.addEventListener("message",(function(n){var o,i,r=n.origin;-1===t.indexOf(r)&&console.warn("origin : ".concat(r," , is not legal")),e.autoReportView||(n.data.start&&(e.autoReportView=!0,document.addEventListener("mousemove",Ne)),n.data.end&&(e.autoReportView=!1,document.removeEventListener("mousemove",Ne)),n.data.start&&(null===(o=e.monitor.config.plugins)||void 0===o?void 0:o.h5)&&((i=document.createElement("script")).type="text/javascript",i.src="https://cdn.jsdelivr.net/npm/@vant/touch-emulator",document.getElementsByTagName("head")[0].appendChild(i)))}),!1)},startCircle:function(){},endCircle:function(){},webListener:function(e,t){var n=Te(e,e.target);this.report(n,t)},scrollHandle:function(e,t,n){var o=Te(e,e.target);this.report(o,n)},report:function(e,t){this.autoReportView&&window.parent.postMessage(e,"*");var n={};e&&Object.keys(e).forEach((function(t){t!==$.EVENT&&t!==$.XPATH&&(n[t]=e[t])}));var o={app_version:t.config.appVersion,happen_time:(new Date).getTime(),action:e.action,action_value:e.element_content,module:e.position,page:se(t.config),page_from:""};t.actionInfo(o)},destroy:function(){this.scrollListener&&document.removeEventListener("scroll",this.scrollListener),this.clickListener&&document.removeEventListener("click",this.clickListener)}}),Ie=function(e){var t="";e.hasChildNodes()&&e.childNodes.forEach((function(e){e.nodeType===Node.TEXT_NODE&&(t=e.nodeValue?e.nodeValue.trim():"")}));return t},Te=function(e,n,o){return t({action:e.type,position:te(n)||"",element_id:n instanceof Element&&n.getAttribute("id")||"",element_content:n instanceof Element&&Ie(n)||"",element_type:n.nodeName?n.nodeName.toLowerCase():"",element_style:n instanceof Element?n.getAttribute("style"):"",element_class:n instanceof Element&&n.getAttribute("class")||"",element_link:n instanceof Element&&n.getAttribute("src")||""},o)};function Ne(e){var t=e.target,n=document.getElementById("auto-track-can-circle-area");if(Oe(t))if(n){Le(n,t.getBoundingClientRect())}else{var o=document.createElement("div");o.setAttribute("id","auto-track-can-circle-area"),Le(o,t.getBoundingClientRect()),document.body.appendChild(o)}else!function(){var e=document.getElementById("auto-track-can-circle-area");e&&document.body.removeChild(e)}()}function Le(e,t){var n=e;n.style.width="".concat(t.width,"px"),n.style.height="".concat(t.height,"px"),n.style.top="".concat(t.y,"px"),n.style.left="".concat(t.x,"px")}!function(e){e[e.Must=0]="Must",e[e.AllowEmpty=1]="AllowEmpty"}(Ce||(Ce={})),function(e){e[e.String=0]="String",e[e.Number=1]="Number"}(Re||(Re={}));var Pe={action:{type:Re.String,rule:Ce.Must},module:{type:Re.String,rule:Ce.Must},page:{type:Re.String,rule:Ce.Must}},je={sysId:{type:Re.String,rule:Ce.Must,msg:"sysId 请传入有效的系统名称字符串,例如xmonitor"},mode:{type:Re.String,rule:Ce.Must,msg:"mode 请传入有效的环境标识字符串 beta 或 idc"}},Ae=new T({name:"quality",onNewMonitor:function(e){var t=e.config;qe(je,t),e.lifeCycle.on("beforeActionReportQuality",(function(t){"idc"!==e.config.mode&&qe(Pe,t)}))}});function qe(e,t){Object.keys(e).forEach((function(n){var o;e[n].rule===Ce.Must&&("string"!=typeof(o=t[n])||""===o.trim())&&console.error("".concat(W.QUALITY_VERIFY,": ").concat(e[n].msg||"".concat(n," 不能为空或空字符串")))}))}return ee.use(ke),ee.use(X),ee.use(_e),ee.use(Ee),ee.use(Se),ee.use(Ae),ee}));
