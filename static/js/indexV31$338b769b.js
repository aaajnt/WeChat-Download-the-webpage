var OfficialIndex={init:function(){var e=window.navigator.userAgent;this.isMobile=e.match(/Android/i)||-1!=e.indexOf("iPhone")||-1!=e.indexOf("iPod")||-1!=e.indexOf("iPad"),this.isSafari=-1!=e.indexOf("Safari")&&-1==e.indexOf("Chrome"),this.isEdgeLowVer=-1!=e.toLowerCase().indexOf("edge")&&e.toLowerCase().match(/edge\/([\d.]+)/)[1]-0<40,this.bindScrollEvents(),this.initBannerVideo3(),this.pageSpeedReport(),this.initWxContactSection(),this.initCollaborationSection(),this.initFunctionSection(),this.bindDownloadEvents(),this.initChangeLogSection(),this.initMobileNav(),this.bindOtherEvents(),this.stayTimeReport(),this.initTxPlayer(),this.initOffCanvas(),this.initMacDownload(),this.initAutoDomReport(),this.bindScrollLogEvents(),this.initMobileVideoMore(),this.reportFps(5),this.reportFps(10),this.reportFps(30)},_isIEVersion:function(e){var i=document.createElement("b");return i.innerHTML="\x3c!--[if IE "+e+"]><i></i><![endif]--\x3e",1===i.getElementsByTagName("i").length},_visibleAPIBrowerKernel:function(){var e;return void 0!==document.hidden?e="origin":["webkit","moz","o","ms"].forEach((function(i){void 0!==document[i+"Hidden"]&&(e=i)})),e},_report:function(e){new Image(1,1).src="/wework_admin/report?q="+encodeURIComponent(e)+"&r="+Math.random()+"&_t="+(new Date-0)},reportlog:function(e,i){seajs.use([window.LOG_REPORT_LIB_PATH],(function(t){t.stat(e,i)}))},reportFpsLog:function(e,i,t){var o;o=e<=10?"fps_1lt10":e<=20?"fps_10lt20":e<=30?"fps_20lt30":e<=40?"fps_30lt40":e<=50?"fps_40lt50":e<=60?"fps_50lt60":"fps_gt60",t&&(o=o+"_"+t),o=(o=o+"_"+i+"s").toLowerCase(),this.reportlog("logkvauto_report",{kv:52603,key:o,value:1})},reportFps:function(e){if(window.requestAnimationFrame){var i=this,t=!1;setTimeout((function(){t=!0}),1e3*e);var o=0,n=Date.now(),a=function(){if(t){var s=1e3*o/(Date.now()-n);return i.reportFpsLog(s,e),i.reportFpsLog(s,e,i.videoRatio||"img"),void((isIE||i.isEdgeLowVer)&&i.reportFpsLog(s,e,"ieorlowedge_"+(i.videoRatio||"img")))}o++,window.requestAnimationFrame(a)};a()}},initAutoDomReport:function(){var e=this;$(document).on("click","[data-js-click-report-log]",(function(i){var t=this.getAttribute("data-js-click-report-log"),o=this.getAttribute("href"),n=this.getAttribute("target")||"_self",a=t.split(","),s=a[0],r=a[1];e.reportlog("sgkvuin_report",{kv:s.trim?s.trim():s,key:r.trim?r.trim():r,id:0,corpid:0,value:1}),o&&0!=o.indexOf("#")&&0!=o.indexOf("javascript")&&(setTimeout((function(){window.open(o,n)}),200),i.preventDefault())})),$("[data-js-hover-report-log]").on("mouseenter",(function(){var i=this.getAttribute("data-js-hover-report-log").split(","),t=i[0],o=i[1];e.reportlog({kv:t.trim?t.trim():t,key:o.trim?o.trim():o,id:0,corpid:0,value:1})}))},initBannerVideo:function(){var e=document.createElement("video"),i=document.createElement("source"),t={width:"1920",preload:"auto",autoplay:"autoplay",loop:"loop",muted:"muted"};for(var o in t)e.setAttribute(o,t[o]);window.devicePixelRatio>=2?i.setAttribute("src",earthVideoHDSource):i.setAttribute("src",earthVideoSource),i.setAttribute("type","video/mp4"),e.appendChild(i),e.style.opacity=0,document.getElementById("index_head_earthVideoWrap").appendChild(e),e.addEventListener("canplaythrough",(function i(){e.currentTime,e.style.opacity=.99,e.removeEventListener("canplaythrough",i,!1),document.getElementById("index_head_earthVideoPoster").style.display="none"}),!1)},controlByUrl:function(){var e=window.location.search.match(/[\&\?]video_banner=(\w+)/);return e&&e[1].toLowerCase()},isInGrey:function(e){return!e&&(isIE||this.isEdgeLowVer)&&Math.random()<.3},initBannerVideo3:function(){var e=this.controlByUrl(),i=document.getElementById("index_head_earthVideoBox");if(i)if(this.isMobile||"img"===e||this.isInGrey(e))i.parentNode.removeChild(i);else{if(e)"1x"===e?i.setAttribute("src",video1XSource):"2x"===e?i.setAttribute("src",video2XSource):"3x"===e&&i.setAttribute("src",video3XSource),this.videoRatio=e;else{var t=Math.ceil(window.devicePixelRatio);t<=1?i.setAttribute("src",video1XSource):2===t?i.setAttribute("src",video2XSource):t>=3&&i.setAttribute("src",video3XSource),this.videoRatio=(t>3?3:t)+"x"}i.addEventListener("canplaythrough",(function(){console.log("video play"),document.getElementById("index_head_earthVideoPoster").classList.add("index_am_fadeOut2"),i.classList.add("index_am_fadeIn2"),i.play()}))}},initBannerVideo2:function(){if(!this.isMobile){document.getElementById("index_head_earthVideoPoster").classList.add("index_am_fadeOut2");var e=document.getElementById("index_head_earthVideoBox");e&&(e.play(),e.classList.add("index_am_fadeIn2"))}},bindScrollEvents:function(){var e=this;e.isAddIndexTopClass=!1,e.isLazyLoadNewsDone=!1,e.isLazyloadCaseAndLogosPicsDone=!1,e.isLazyloadLogosPicsDone=!1;var i=window.innerWidth-$(".js_frame_container").width(),t=i/2;console.log(i);var o=document.getElementById("indexHead"),n=!0,a=document.getElementById("js_index_main").offsetTop||700,s=$(".frame_container");if(e.isMobile){var r=!1;s.scroll((function(i){s.scrollTop()>561?(r||($(".js_mobileTop").velocity("slideDown",{duration:100}),$(".js_mobileNav_menu").addClass("index_mobileNav_menu_Fixed"),r=!0),e.isLazyLoadNewsDone||e.lazyLoadNews()):r&&($(".js_mobileTop").velocity("slideUp",{duration:100}),$(".js_mobileNav_menu").removeClass("index_mobileNav_menu_Fixed"),r=!1)}))}else{var d;window.onmousewheel=function(){};var l=!1,c=!1,_=function(i){if(l)d=document.body.scrollTop;else if(d=$("html").scrollTop(),!c){var s=d;d=document.body.scrollTop,(s>0||d>0)&&(c=!0),d>0&&(l=!0)}!function(i){if(i<0&&(i=0),i>=400?.9:0==i?0:i/400,e.isSafari&&(i>a?n&&(n=!1):n||(n=!0)),!isIE){var s="";void 0!==document.body.style.transform?s="transform":["webkit","moz","o","ms"].forEach((function(e){void 0!==document.body.style[e+"Transform"]&&(s=e+"Transform")})),s?o.style[s]="translate3d(0,"+.5*i+"px,0)":o.style.top=.5*i+"px"}i>200&&(e.isLazyloadCaseAndLogosPicsDone||e.lazyLoadCaseAndLogosPics()),i>644?(e.isLazyLoadNewsDone||e.lazyLoadNews(),e.isAddIndexTopClass||(e.isAddIndexTopClass=!0,$(".index_top").addClass("index_top_White").removeClass("index_top_Init"),$(".index_top_White").hide().slideDown(150),$(".index_top_inside").css("left","-"+t+"px"))):e.isAddIndexTopClass&&(e.isAddIndexTopClass=!1,$(".index_top_White").slideUp(150,(function(){$(".index_top").removeClass("index_top_White").addClass("index_top_Init").show(),$(".index_top_inside").css("left",0)})))}(d)};_(),window.addEventListener("scroll",_)}},bindScrollLogEvents:function(){var e=this,i=[];$("[data-js-scroll-report-log]").each((function(e,t){var o=$(this).attr("data-js-scroll-report-log").split(","),n=o[0],a=o[1];i.push({dom:t,isLogged:!1,key:a,kv:n,rect:t.getBoundingClientRect()})}));var t=null,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=$("html")[0];function a(){o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i.forEach(s)}function s(i){!i.isLogged&&function(e,i){var t=e.top-n.scrollTop;return e&&t<=i&&t>=-100}(i.rect,o)&&(i.isLogged=!0,e.reportlog({kv:i.kv,key:i.key,id:0,corpid:0,value:1}))}window.addEventListener("scroll",(function(){clearTimeout(t),t=setTimeout(a,500)})),i.forEach(s)},initBannerAnim:function(){if(this.isMobile)return!1;var e={wrapper:document.getElementById("js_v3Style_am"),animType:"html",loop:!0,prerender:!0,autoplay:!0,path:window.bodymovinDataPath};this.bodymovinAnim=window.bodymovin.loadAnimation(e)},lazyLoadNews:function(){var e=this;if(e.isLazyLoadNewsDone)return!1;e.isLazyLoadNewsDone=!0,console.log("lazyLoadNews"),_.debounce((function(){var i=$(".js_index_newsList");if(i.children()&&i.children().length)return!1;$.ajax({type:"GET",url:"/nl/index/news_list",dataType:"json",data:{limit:2,from:"ww_index"},success:function(t){e.isLazyLoadNewsDone=!0;var o="";(t.list||[]).forEach((function(e){o+=function(e){return 0==+(e=e||{}).tasktype?'<li class="index_log_section_list_item index_log_section_list_news"><a href="/nl/index/news?from=ww_index" target="_blank"><span class="index_log_section_list_news_title">'+e.title+'</span><i class="ww_officialImg  ww_officialImg_Activities"></i></a></li>':'<li class="index_log_section_list_item index_log_section_list_news"><a href="/nl/index/news?from=ww_index" target="_blank"><span class="index_log_section_list_news_title">'+e.title+'</span><span class="index_log_section_list_date">'+e.event_time_str+"</span></a></li>"}(e)})),i.html(o)},error:function(i){console.log(i),e.isLazyLoadNewsDone=!1,e.lazyLoadNews()}})}),500)()},_replaceDataSrcToSrc:function(e,i){$(e).each((function(){var e=$(this).data("src");e&&$(this).attr("src",e)})),$(i).attr("data-done","1")},lazyLoadCaseAndLogosPics:function(){if(this.isMobile)return!1;this.isLazyloadCaseAndLogosPicsDone=!0,console.log("lazyLoadCaseAndLogosPics"),"1"!==$(".js_caselist").attr("data-done")&&this._replaceDataSrcToSrc(".js_caselist_pic",".js_caselist"),"1"!==$(".index_logo_wall_lazy").attr("data-done")&&this._replaceDataSrcToSrc(".index_logo_wall_img",".index_logo_wall_lazy")},bindDownloadEvents:function(){if(this.isMobile)return!1;window.adclick&&($(".index_download_item_Window").on("click",(function(){var e=window.fbq,i=window.gtag;e?e("track","Download_Windows"):i&&i("event","conversion",{send_to:"AW-658693545/ObfiCO2OocoBEKm7i7oC"})})),$(".index_download_item_Mac").on("click",(function(){var e=window.fbq,i=window.gtag;e?e("track","Download_Mac"):i&&i("event","conversion",{send_to:"AW-658693545/y8h4CLT7tMoBEKm7i7oC"})})));var e=function(e,i,t){var o=4*t;isIE||isFF?$('[plat="'+e+'"] img')[0].src="https://work.weixin.qq.com/wework_admin/genqrcode?action=commdownload&platform="+e+"&from="+i+"&qr_size="+o:$('[plat="'+e+'"] img')[0].style.content='url("https://work.weixin.qq.com/wework_admin/genqrcode?action=commdownload&platform='+e+"&from="+i+"&qr_size="+o+'")'};e("ios",comeFrom,window.devicePixelRatio),e("android",comeFrom,window.devicePixelRatio)},initTxPlayer:function(){var e=this;if(e.isMobile)return!1;var i=$(".js_index_video_playBtn"),t=$(".js_index_videoDialogCLose");if(!Txplayer){console.log("Txplayer no reg!");var o=document.getElementsByTagName("head")[0],n=document.createElement("script");n.type="text/javascript",n.src="https://wwcdn.weixin.qq.com/node/wework/css/txplayer.b1f9e914a9.js",o.appendChild(n)}console.log("start reg Txplayer");i&&i.click((function(){var i=$(this).attr("vid");$(".ww_mask").addClass("ww_mask_Show"),e.playingPlayer=function(e){return new Txplayer({containerId:"js_index_VideoWrap",width:"100%",vid:e||"p0768c8s7xm",isHtml5UseFakeFullScreen:!0,height:556,poster:"none",settings:{UiControl:{subPlugins:["UiControlPlay","UiPlayNext","UiShowTime","UiBarrageBtn","UiVolume","UiProgress","UiSettings","UiOverlayPlay","UiDefinition","UiWindowFullScreen"]}}})}(i),$(".js_index_Video").show(),e.playingPlayer.play?e.playingPlayer.play({vid:i}):e.playingPlayer.on("ready",(function(){e.playingPlayer.dropped||e.playingPlayer.play({vid:i})}))})),t&&t.click((function(i){$(".ww_mask").removeClass("ww_mask_Show"),$(".js_index_Video").hide(),e.playingPlayer.stop(),e.playingPlayer.dropped=!1,e.playingPlayer=null}))},pageSpeedReport:function(){var e="navigationStart|unloadEventStart|unloadEventEnd|redirectStart|redirectEnd|fetchStart|domainLookupStart|domainLookupEnd|connectStart|connectEnd|requestStart|responseStart|responseEnd|domLoading|domInteractive|domContentLoadedEventStart|domContentLoadedEventEnd|domComplete|loadEventStart|loadEventEnd".split("|"),i=new Date-36e5,t=Number("300000")||3e5;!function(o){if(o){var n=window,a=n.document,s=!1,r=(n.webkitPerformance||n.performance).timing;if(r.loadEventEnd)_();else{function d(){l&&n.clearInterval(l),c&&n.clearTimeout(c),l=c=null}a.addEventListener&&a.addEventListener("load",(function(){d(),_()}),!1);var l=n.setInterval((function(){r.loadEventEnd&&(d(),_())}),500),c=n.setTimeout((function(){d(),_()}),5e3)}}function _(){s||(s=!0,n.setTimeout((function(){var n=r[e[0]];if(!(n<i)){for(var a=[],s=1,d=e.length;s<d;s++){var l=Math.round((r[e[s]]||0)-n);if(l>=0){var c="st:speed=k="+(o+s-1)+"&v="+l;if(a.push("q="+encodeURIComponent(c)),l>t){a=[];break}}}a.length&&(a.push("q="+encodeURIComponent("st:speed=k="+(o+19)+"&v="+(r.requestStart-r.domainLookupStart))),a.push("q="+encodeURIComponent("st:speed=k="+(o+20)+"&v="+(r.responseStart-r.requestStart))),a.push("q="+encodeURIComponent("st:speed=k="+(o+21)+"&v="+(r.responseEnd-r.responseStart))),a.push("q="+encodeURIComponent("st:speed=k="+(o+22)+"&v="+(r.domContentLoadedEventStart-r.domLoading))),new Image(1,1).src="/wework_admin/report?"+a.join("&"))}}),0))}}(78501950)},initWxContactSection:function(){var e=(this.isMobile,"click");$(".js_wxcontacts_tab").on(e,(function(e){var i=$(this)||$(e.target),t=i.data("index");$(".js_wxcontacts_tab").removeClass("index_section_wxContacts_tab_item_Act"),$(".js_wxcontacts_tab .ww_officialImg").removeClass("index_am_zoom"),i.addClass("index_section_wxContacts_tab_item_Act"),i.find(".ww_officialImg").addClass("index_am_zoom"),$(".js_wxcontacts_tabContent > li").not(":eq("+t+")").hide();var o=$(".js_wxcontacts_tabContent > li:eq("+t+")");o.show(),o.find(".index_section_wxContacts_main_img").addClass("index_am_fadeInRight"),o.find(".index_section_wxContacts_main_part:eq(0)").css("opacity",1)}))},initCollaborationSection:function(){var e=(this.isMobile,"click");$(".js_collaboration_tab").on(e,(function(e){var i=$(this)||$(e.target),t=i.data("index");$(".js_collaboration_tab").removeClass("index_section_wxContacts_tab_item_Act"),$(".js_collaboration_tab .ww_officialImg").removeClass("index_am_zoom"),i.addClass("index_section_wxContacts_tab_item_Act"),i.find(".ww_officialImg").addClass("index_am_zoom"),$(".js_collaboration_tabContent > li").not(":eq("+t+")").hide();var o=$(".js_collaboration_tabContent > li:eq("+t+")");o.show(),o.find(".index_section_wxContacts_main_img").addClass("index_am_fadeInRight"),o.find(".index_section_wxContacts_main_part:eq(0)").css("opacity",1)}))},initMobileNav:function(){if(this.isMobile){var e=$(".js_mobileNav_menu"),i=($(".js_mobileNav_more_sub"),$(".js_mobileNav_more"));$(".js_mobileNav_nav").on("tap",(function(i){return i.stopPropagation(),$(this).hasClass("index_mobileTop_nav"),"none"===e.css("display")?e.velocity("slideDown",{duration:200}):e.velocity("slideUp",{duration:200}),!1})),i.on("tap",(function(){var e=$(this).children(".js_mobileNav_more_sub");"none"===e.css("display")?e.velocity("slideDown",{duration:200}):e.velocity("slideUp",{duration:200})})),$("div").parents().on("tap",(function(i){return i.stopPropagation(),0===e.has(i.target).length&&e.velocity("slideUp",{duration:200}),!1}))}},initMobileVideoMore:function(){this.isMobile&&($(".js_bottomVideo_more").on("click",(function(e){return e.stopPropagation(),$(".js_mask").addClass("ww_mask_Show"),$(".js_videoNavPopDialog").show(),!1})),$(".js_videoNavPopDialog_close").on("click",(function(e){return e.stopPropagation(),$(".js_mask").removeClass("ww_mask_Show"),$(".js_videoNavPopDialog").hide(),!1})))},bindOtherEvents:function(){var e=this;$(".js_open_website").on("click",(function(){e._report("u=index_go_open_website")}))},initFunctionSection:function(){var e=this,i=$(".js_feature_extend_flod_btn");i.on("click",(function(t){var o=$(t.currentTarget),n=$(".js_feature_flod_container");o.hasClass("js_feature_status_extend")?(e._isIEVersion(8)||e._isIEVersion(9)?n.hide():n.velocity("slideUp",{duration:200}),i.removeClass("js_feature_status_extend index_section_operate_more_Collapse"),e._report("u=index|btn_click|feature|close")):(e._isIEVersion(8)||e._isIEVersion(9)?n.show():n.velocity("slideDown",{duration:200}),i.addClass("js_feature_status_extend index_section_operate_more_Collapse"),e._report("u=index|btn_click|feature|open"))}))},initChangeLogSection:function(){var e=this;$(".index_log_cnt").on("click",".js_version_title_btn",(function(i){var t=$(i.currentTarget).next(".js_log_list");t.parents(".index_log_section").hasClass("index_log_section_Open")?e._isIEVersion(8)||e._isIEVersion(9)?t.hide().parents(".index_log_section").removeClass("index_log_section_Open"):t.velocity("slideUp",{duration:200}).parents(".index_log_section").removeClass("index_log_section_Open"):e._isIEVersion(8)||e._isIEVersion(9)?t.show().parents(".index_log_section").addClass("index_log_section_Open"):t.velocity("slideDown",{duration:200}).parents(".index_log_section").addClass("index_log_section_Open")})),e.isLogSectionWrapShow=!1,$(".js_log_operate").on("click",(function(i){e.getUpdateLogSubs()}))},getUpdateLogSubs:function(){var e=this,i=$(".js_log_indentList");i.children().length?e.handleUpdateLogSubsEvent():($.ajax({type:"POST",url:"/nl/index/log",dataType:"json",data:{from:"ww_index"},success:function(t){var o=t.data&&t.data.html||"";o&&(i.html(o),e.handleUpdateLogSubsEvent())},error:function(e){console.log(e)}}),e._report("u=index_open_log_subs"))},handleUpdateLogSubsEvent:function(){var e=$(".index_log_sectionWrap");this.isLogSectionWrapShow?(this._isIEVersion(8)||this._isIEVersion(9)?e.hide():e.velocity("slideUp",{duration:200}),$(".index_log_operate").removeClass("index_log_operate_Collapase")):(this._isIEVersion(8)||this._isIEVersion(9)?e.show():e.velocity("slideDown",{duration:200}),$(".index_log_operate").addClass("index_log_operate_Collapase")),this.isLogSectionWrapShow=!this.isLogSectionWrapShow},stayTimeReport:function(){var e,i=this,t=0,o=null,n=1e4;function a(){t<10&&(o=new Date,n<0&&(n=0),e=setTimeout((function(){n=1e4,i._report("k=index|user|time|"+ ++t+"0"),a()}),n))}if(!isIE){var s=i._visibleAPIBrowerKernel();document.addEventListener("origin"==s?"visibilitychange":s+"visibilitychange",(function(){"visible"==("origin"==s?document.visibilityState:document[s+"VisibilityState"])?a():(n-=new Date-o,e&&clearTimeout(e))}),!1)}a()},initOffCanvas:function(){if(this.isMobile){var e=$(".js_offCanvas_close, .js_offCanvas_mask"),i=$(".js_mainBody");e.on("click",(function(e){i.toggleClass("frame_mainBody_Open")})),$(".frame_offCanvas_multiNav_item_link, .frame_offCanvas_multiNav_sub_item").on("click",(function(e){i.toggleClass("frame_mainBody_Open")}))}},initMacDownload:function(){var e=this,i=$(".js_mask"),t=$("#macDownloadDialog");$(".js_mac_download").on("click",(function(o){o.preventDefault(),i.addClass("ww_mask_Show"),t.show(),e.reportlog("sgkvuin_report",{kv:79506103,key:"click_mac_icon_download",id:0,corpid:0,value:1})})),$("#macDownloadDialog_close").on("click",(function(){i.removeClass("ww_mask_Show"),t.hide(),e.reportlog("sgkvuin_report",{kv:79506103,key:"click_mac_icon_close_popup",id:0,corpid:0,value:1})}))}};window.onload=function(){OfficialIndex.init()};