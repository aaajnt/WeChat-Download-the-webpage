var BJ_REPORT=function(v){if(v.BJ_REPORT)return v.BJ_REPORT;var l=[];var c={uin:0,url:"https://badjs.weixinbridge.com/badjs",combo:0,level:4,ignore:[],random:1,delay:0,submit:null};var d=function(e,r){return Object.prototype.toString.call(e)==="[object "+(r||"Object")+"]"};var f=function(e){var r=typeof e;return r==="object"&&!!e};var E=function(e){if(e===null)return true;if(d(e,"Number")){return false}return!e};function D(){if(c.id!=n.IDS.DEFAULT||c.key!=n.KEY){return{id:c.id,key:c.key}}var e={_href:location.href,href:location.href.replace("https://mp.weixin.qq.com/","")};if(e.href.indexOf("?")>-1){e.cgi=e.href.match(/.*?\?/g)[0].slice(0,-1)}else{e.cgi=e.href}var r=(e.href+"&").match(/action\=(.*?)&/);if(r&&r[1]){e.action=r[1]}var i=n.IDS.DEFAULT;var t=n.KEY;if(e.cgi=="cgi-bin/masssendpage"){i=n.IDS.MASS;t=66}else if(e.cgi=="advanced/autoreply"){i=n.IDS.AUTO_REPLY;t=70}else if(e.cgi=="advanced/selfmenu"){i=n.IDS.SELF_MENU;t=68}else if(e.cgi=="misc/appmsgcomment"){i=n.IDS.COMMENT;t=71}else if(e.cgi=="cgi-bin/newoperatevote"){i=n.IDS.VOTE;t=72}else if(e.cgi=="misc/kf"){i=n.IDS.KF;t=73}else if(e.cgi=="merchant/rewardstat"||e.cgi=="merchant/reward"){i=n.IDS.REWARD;t=74}else if(e.cgi=="cgi-bin/appmsgcopyright"||e.cgi=="cgi-bin/imgcopyright"||e.cgi=="cgi-bin/ori_video"){i=n.IDS.COPYRIGHT;t=75}else if(e.cgi=="cgi-bin/message"){i=n.IDS.MSG;t=76}else if(e.cgi=="cgi-bin/user_tag"){i=n.IDS.USER;t=77}else if(e.cgi=="cgi-bin/appmsg"&&(e.action=="list_card"||e.action=="list")||e.cgi=="cgi-bin/filepage"){i=n.IDS.LIST;t=78}else if(e.cgi=="cgi-bin/operate_voice"){i=n.IDS.AUDIO;t=79}else if(e.cgi=="cgi-bin/appmsg"&&e.action=="video_edit"){i=n.IDS.VEDIO;t=80}else if(e.cgi=="cgi-bin/appmsg"&&e.action=="edit"){i=n.IDS.APPMSG;t=62}else if(e.cgi=="cgi-bin/frame"&&/t=ad_system/.test(e.href)||/merchant\/ad_/.test(e.cgi)){i=n.IDS.AD;t=81}else if(e.cgi=="misc/useranalysis"||e.cgi=="misc/appmsganalysis"||e.cgi=="misc/menuanalysis"||e.cgi=="misc/messageanalysis"||e.cgi=="misc/interfaceanalysis"){i=n.IDS.ANALYSIS;t=82}else if(e.cgi=="cgi-bin/settingpage"||e.cgi=="acct/contractorinfo"){i=n.IDS.SETTING;t=83}else if(e.cgi=="merchant/store"||e.cgi=="merchant/order"||e.cgi=="acct/wxverify"){i=n.IDS.VERIFY;t=84}else if(e.cgi=="cgi-bin/safecenterstatus"){i=n.IDS.SAFE;t=85}else if(e.cgi=="cgi-bin/illegalrecord"){i=n.IDS.ILLEGAL;t=86}else if(e.cgi=="advanced/advanced"||e.cgi=="advanced/diagram"||e.cgi=="cgi-bin/frame"&&/t=advanced\/dev_tools_frame/.test(e.href)){i=n.IDS.ADVANCED;t=87}else if(e.cgi=="acct/contractorpage"){i=n.IDS.REGISTER;t=88}else if(e.cgi=="cgi-bin/readtemplate"){i=n.IDS.TMPL;t=89}else if(e.cgi=="advanced/tmplmsg"){i=n.IDS.TMPLMSG;t=90}else if(e.cgi=="merchant/entityshop"||e.cgi=="merchant/newentityshop"){i=n.IDS.SHOP;t=92}else if(e.cgi=="merchant/goods"||e.cgi=="merchant/goodsgroup"||e.cgi=="merchant/shelf"||e.cgi=="merchant/goodsimage"||e.cgi=="merchant/delivery"||e.cgi=="merchant/productorder"||e.cgi=="merchant/merchantstat"||e.cgi=="merchant/introduction"||e.cgi=="merchant/merchantpush"||e.cgi=="merchant/merchantentrance"){i=n.IDS.MERCHANT;t=104}else if(e.cgi=="cgi-bin/home"){i=n.IDS.HOME;t=93}else if(e.cgi=="merchant/cardapply"&&e.action=="listapply"){t=95}else if(e.cgi.indexOf("beacon")>-1){i=n.IDS.IBEACON;t=96}c.id=i;c.key=t;if(wx&&wx.lang=="en_US"){i=125;t=125}return{id:i,key:t}}function y(e,r){if(e.indexOf("TypeError: #<KeyboardEvent> is not a function")>-1||e.indexOf("TypeError: #<MouseEvent> is not a function")>-1){return false}if(e.indexOf("ReferenceError: LIST_INFO is not defined")>-1){return false}if(e.indexOf("TypeError: e is not a constructor")>-1){return false}if(location&&/token=\d+/.test(location.href)&&wx.uin=="0"){return false}if(/Mozilla\/5.0.*ipad.*BaiduHD/i.test(r)&&e.indexOf("ReferenceError: Can't find variable: bds")>-1){return false}if(/Linux; U; Android.*letv/i.test(r)&&e.indexOf("ReferenceError: diableNightMode is not defined")>-1){return false}return true}var R=function(e){try{if(e.stack){var r=e.stack.match("https?://[^\n]+");r=r?r[0]:"";var i=r.match(":(\\d+):(\\d+)");if(!i){i=[0,0,0]}var t=A(e).replace(/https?\:\/\/.*?\.js\:/g,"");if(y(t,window.navigator.userAgent)==false){return null}return{msg:t,rowNum:i[1],colNum:i[2],target:r.replace(i[0],"")}}else{return e}}catch(a){return e}};var A=function(e){var r=e.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,5).join("@").replace(/\?[^:]+/gi,"");var i=e.toString();if(r.indexOf(i)<0){r=i+"@"+r}return r};var _=function(e,r){var i=[];var t=[];var a=[];if(f(e)){e.level=e.level||c.level;for(var s in e){var o=e[s];if(!E(o)){if(f(o)){try{o=JSON.stringify(o)}catch(m){o="[BJ_REPORT detect value stringify error] "+m.toString()}}a.push(s+":"+o);i.push(s+"="+encodeURIComponent(o));t.push(s+"["+r+"]="+encodeURIComponent(o))}}}return[t.join("&"),a.join(","),i.join("&")]};var O=[];var p=[];var h=function(e){var r=e.replace(/\&_t=\d*/,"");for(var i in p){if(p[i]==r){return}}p.push(r);if(c.submit){c.submit(e)}else{var t=new Image;O.push(t);t.src=e}var a="error";a=e.match(/msg=(.*?)&/);if(a&&a[1]){a=a[1]}if(wx&&wx.uin){a+=encodeURIComponent("|uin|"+wx.uin)}if(c.key){var t=new Image;t.src="/misc/jslog?id="+c.key+"&content="+a+"&level=error"}var s=new Image;s.src="/misc/jslog?id=65&content="+a+"&level=error"};var g=[];var u=0;var I=function(e){if(!c.report)return;while(l.length){var r=false;var i=l.shift();var t=_(i,g.length);if(d(c.ignore,"Array")){for(var a=0,s=c.ignore.length;a<s;a++){var o=c.ignore[a];if(d(o,"RegExp")&&o.test(t[1])||d(o,"Function")&&o(i,t[1])){r=true;break}}}if(!r){if(c.combo){g.push(t[0])}else{h(c.report+t[2]+"&_t="+ +new Date)}c.onReport&&c.onReport(c.id,i)}}var m=g.length;if(m){var S=function(){clearTimeout(u);h(c.report+g.join("&")+"&count="+m+"&_t="+ +new Date);u=0;g=[]};if(e){S()}else if(!u){u=setTimeout(S,c.delay,true)}}};var n={KEY:67,IDS:{DEFAULT:"5",MASS:"6",SELF_MENU:"7",LINK:"11",AUTO_REPLY:"12",COMMENT:"13",VOTE:"14",KF:"15",REWARD:"16",COPYRIGHT:"17",MSG:"18",USER:"19",LIST:"20",AUDIO:"21",VEDIO:"22",APPMSG:"4",AD:"23",ANALYSIS:"24",SETTING:"25",VERIFY:"26",SAFE:"27",ILLEGAL:"28",ADVANCED:"29",REGISTER:"30",TMPL:"31",IE:"32",CARD:"33",SHOP:"34",TMPLMSG:"35",HOME:"36",Android:"37",IOS:"38",IBEACON:"72",MERCHANT:"82"},destory:function(){I=function(){}},push:function(e,r){if(Math.random()>=c.random){return n}var i;if(f(e)){i=R(e);if(r){i.msg+="["+r+"]"}if(i){if(i.target&&/^https?\:\/\/(mp\.weixin\.qq\.com|res\.wx\.qq\.com)/.test(i.target)==false){return n}else{l.push(i)}}}else{if(r){e+="["+r+"]"}l.push({msg:e})}I();return n},report:function(e,r){e&&n.push(e,r);return n},info:function(e){if(!e){return n}if(f(e)){e.level=2}else{e={msg:e,level:2}}n.push(e);return n},debug:function(e){if(!e){return n}if(f(e)){e.level=1}else{e={msg:e,level:1}}n.push(e);return n},init:function(e){for(var i in e){c[i]=e[i]}var r=parseInt(c.id,10);var i=parseInt(c.key,10);if(window.navigator.userAgent&&/;\s*MSIE\s*[8|7]\.0b?;/i.test(window.navigator.userAgent)){r=n.IDS.IE;i=0}else if(window.navigator.userAgent.indexOf("Android")>-1||window.navigator.userAgent.indexOf("Adr")>-1){r=n.IDS.Android;i=0}else if(!!window.navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)){r=n.IDS.IOS;i=0}if(r&&i){c.report=c.url+"?id="+r+"&key="+i+"&uin="+(wx&&wx.uin)+"&from="+encodeURIComponent(location.href)+"&"}return n},monitor:function(e,r,i){r=r||"badjs|monitor";if(e){var t=new Image;t.src="/misc/jslog?id="+e+"&content="+encodeURIComponent(r)+"&level=error"}if(i){var a=new Image;a.src=c.url+"?id="+i+"&msg="+encodeURIComponent(r)+"&uin="+(wx&&wx.uin)+"&from="+encodeURIComponent(location.href)+"&level=4"}},getConfig:function(){return c}};typeof console!=="undefined"&&console.error&&setTimeout(function(){var e=((location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)||[])[2];e&&void 0},0,true);c.id=n.IDS.DEFAULT;c.key=n.KEY;D();n.init();return n}(window);
